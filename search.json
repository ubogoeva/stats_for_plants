[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "О курсе",
    "section": "",
    "text": "Здесь будут размещаться материалы курса “R и статистика в селекции”. Информацию о курсе можно почитать здесь.\nАвторы курса: Елена Убогоева (@lena_astr), автор телеграм-канала “Статистика и R” и Надежда Долматова (@HopeNeverDie), автор телеграм-канала ЧТОПОСЕЕШЬ.ORG."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R и статистика в селекции",
    "section": "",
    "text": "Это сайт курса “R и статистика в селекции” и здесь будут размещаться ссылки на презентации.\nСайт сделан в R с помощью Quarto, с исходным кодом можно ознакомиться здесь."
  },
  {
    "objectID": "lecture1.html#информация-о-курсе",
    "href": "lecture1.html#информация-о-курсе",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Информация о курсе",
    "text": "Информация о курсе\n\n12 лекций в zoom по одной лекции в неделю: по средам в ~16.30 МСК.\nДомашние задания (по желанию).\nБудет запись каждой лекции, после занятия выложена на диск.\n\nСтруктура курса:\n\n5 лекций по работе в R\nСтатистические методы"
  },
  {
    "objectID": "lecture1.html#почему-важно-изучать-r-в-контексте-статистики-и-селекции",
    "href": "lecture1.html#почему-важно-изучать-r-в-контексте-статистики-и-селекции",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Почему важно изучать R в контексте статистики и селекции?",
    "text": "Почему важно изучать R в контексте статистики и селекции?\n\nБольшинство статистических расчетов реализовано в R, следовательно можно воспользоваться готовым скриптом для своей задачи (с нужными преобразованиями).\nR предоставляет обширный функционал для быстрой и удобной работы с табличными данными (а наши данные являются табличными).\nВоспроизводимость результатов, что реализуется как выкладыванием кода, так и с помощью публикации результатов в системах rmarkdown и Quarto.\nR – бесплатный и с открытым исходным кодом."
  },
  {
    "objectID": "lecture1.html#установка-r-и-rstudio-и-начало-работы",
    "href": "lecture1.html#установка-r-и-rstudio-и-начало-работы",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Установка R и RStudio и начало работы",
    "text": "Установка R и RStudio и начало работы\n\nСкачать и установить свежую версию R с официального сайта (CRAN);\nСкачать и установить IDE RStudio;\nБольше рекомендаций и решений возможных проблем при установке можно почитать здесь;\nAdvanced: настройка проектов и лайфхаки при работе в RStudio."
  },
  {
    "objectID": "lecture1.html#рекомендуемая-литература",
    "href": "lecture1.html#рекомендуемая-литература",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Рекомендуемая литература",
    "text": "Рекомендуемая литература\n\n\nБольшая часть литературы по R на английском, однако начинают появляться в том числе материалы на русском.\n\nR4DataScience - книга для старта изучения R (Hadley Wickham).\nAdvanced R - для продвинутых пользователей, которые хотят разобраться больше в устройстве языка (Hadley Wickham).\nАнализ данных и статистика в R (автор Иван Поздняков).\nВведение в язык программирования R (автор Филипп Управителев)\nБольше литературы здесь и здесь"
  },
  {
    "objectID": "lecture1.html#план-лекции",
    "href": "lecture1.html#план-лекции",
    "title": "R и статистика в селекции: лекция 1",
    "section": "План лекции",
    "text": "План лекции\n\nОсобенности архитектуры языка R.\nПеременные.\nВекторы:\n\nТипы векторов\nИндексация векторов\nНеявное и явное приведение типов\n\nЛогические операторы, булева алгебра\nРабота с пропущенными значениями"
  },
  {
    "objectID": "lecture1.html#история-языка-r",
    "href": "lecture1.html#история-языка-r",
    "title": "R и статистика в селекции: лекция 1",
    "section": "История языка R",
    "text": "История языка R\n\n\nR - язык программирования для статистической обработки данных и визуализации результатов (Википедия).\nНа самом деле R является языком широкого использования, например, с его помощью можно делать сайты, интерактивные приложения (shiny), презентации, писать книги и научные статьи.\nR является наследником языка S, который был создан в отделе статистики AT&T в её исследовательском подразделении Bell Labs в 1976 году.\nR был создан в 1991 в департаменте статистики Университета Окленда, Новая Зеландия. Разработчиками R поддерживается CRAN - репозиторий R-пакетов.\nДля анализа данных есть набор пакетов tidyverse, главный разработчик Hadley Wickham.\nДля работы с биологическими данными есть репозиторий Bioconductor."
  },
  {
    "objectID": "lecture1.html#особенности-архитектуры-языка",
    "href": "lecture1.html#особенности-архитектуры-языка",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Особенности архитектуры языка",
    "text": "Особенности архитектуры языка\nR - высокоуровневый интерпретируемый мультипарадигменный язык программирования.\n\nПарадигмы программирования:\n\nимперативное (процедурное)\nфункциональное\nобъект-ориентированное\n\nТипизация:\n\nдинамическая - не нужно заранее определять тип переменной и тип может меняться в процессе скрипта\nнестрогая - происходит неявное приведение типов\n\n\nБольше про историю языка можно посмотреть здесь."
  },
  {
    "objectID": "lecture1.html#r-как-калькулятор",
    "href": "lecture1.html#r-как-калькулятор",
    "title": "R и статистика в селекции: лекция 1",
    "section": "R как калькулятор",
    "text": "R как калькулятор\nЛюбая книга по базовому R начинается с этого раздела, так что не будем нарушать традицию:\n\n40 + 2 # сложение\n\n[1] 42\n\n\n\n20 - 2 # вычитание\n\n[1] 18\n\n\n\n42 * 2 # умножение\n\n[1] 84\n\n\n\n42 / 2 # деление\n\n[1] 21\n\n\n\n2 ^ 4 # возведение в степень\n\n[1] 16"
  },
  {
    "objectID": "lecture1.html#r-как-калькулятор-1",
    "href": "lecture1.html#r-как-калькулятор-1",
    "title": "R и статистика в селекции: лекция 1",
    "section": "R как калькулятор",
    "text": "R как калькулятор\nФункции для арифметических операторов: sqrt(), log()\n\n\nКвадратный корень\n\nsqrt(16) # квадратный корень, от слова square root\n\n[1] 4\n\n\nЛогарифм\n\nlog(2) # по какому основанию логарифм?\n\n[1] 0.6931472\n\n\nПо умолчанию натуральный логарифм, то есть основание e\n\nlog(exp(1)) # по умолчанию натуральный логарифм\n\n[1] 1"
  },
  {
    "objectID": "lecture1.html#переменные",
    "href": "lecture1.html#переменные",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Переменные",
    "text": "Переменные\nПоскольку R является в первую очередь императивным языком программирования, то переменные и оператор присваивания занимают центральную роль. В качестве оператора присваивания используется &lt;-.\nМожно набрать в RStudio, используя комбинацию клавиш Alt - (альт минус) или Option - на Mac.\nРавно = тоже будет работать, но не рекомендуется к использованию.\nПопробуем создать переменные:\n\nx &lt;- 10\ny &lt;- x + 5\n\nПочему ничего не появилось в консоли в качестве аутпута?\n\n\n\n\n\n\nРавно используется для подачи аргументов в функции: log(x = 8, base = 2)"
  },
  {
    "objectID": "lecture1.html#переменные-1",
    "href": "lecture1.html#переменные-1",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Переменные",
    "text": "Переменные\nПри создании переменной результат сохраняется и не выводится в консоль, если нам нужно узнать значение переменной, то можно использовать print(x) или просто набрать x в консоли.\n\nprint(x)\n\n[1] 10\n\nx\n\n[1] 10\n\ny\n\n[1] 15\n\n\nТакже можно посмотреть на переменные во вкладке environment в правом верхнем углу RStudio"
  },
  {
    "objectID": "lecture1.html#переменные-2",
    "href": "lecture1.html#переменные-2",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Переменные",
    "text": "Переменные\nС точки зрения компьютера в нем создается объект 10, с которым связывается название переменной x. Переменные могут содержать все что угодно: числа, строки, датафреймы.\nПри создании переменных есть определенные правила:\n\nВ названии можно использовать латиницу (строчные и заглавные буквы), нижнее подчеркивание (_), точки, цифры;\nнельзя использовать пробелы в названиях переменных;\nнельзя использовать зарезервированные слова, например, TRUE, FALSE, if, function, с полным списком можно ознакомиться, вызвав ?Reserved.\n\nВ R для разделения длинных имен рекомендуется использовать нижнее подчеркивание, например: data_processed. Главное - последовательность в стиле написания кода.\n\n\n\n\n\n\nПодробнее про рекомендуемый стиль написания кода можно почитать здесь"
  },
  {
    "objectID": "lecture1.html#логические-операторы",
    "href": "lecture1.html#логические-операторы",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Логические операторы",
    "text": "Логические операторы\n\n\nМожно проверять на равенство переменные:\n\nx == y\n\n[1] FALSE\n\ny == 15\n\n[1] TRUE\n\n\nНе путаем операторы сравнения == и присваивания = (поэтому я использую &lt;- как оператор присваивания)."
  },
  {
    "objectID": "lecture1.html#логические-операторы-проверка-на-неравенство",
    "href": "lecture1.html#логические-операторы-проверка-на-неравенство",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Логические операторы: проверка на неравенство",
    "text": "Логические операторы: проверка на неравенство\n\nlogical1 &lt;- x != y \nlogical1 \n\n[1] TRUE\n\nlogical2 &lt;- x != 10 \nlogical2\n\n[1] FALSE\n\n\nРезультаты выполнения логических операций мы можем сохранять в переменные для дальнейшего использования."
  },
  {
    "objectID": "lecture1.html#логические-операторы-сравнение-и-отрицание",
    "href": "lecture1.html#логические-операторы-сравнение-и-отрицание",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Логические операторы: сравнение и отрицание",
    "text": "Логические операторы: сравнение и отрицание\nМожем сравнивать числа, используя знаки &gt;, &lt;, &gt;=, &lt;=.\n\nx &gt; y \n\n[1] FALSE\n\nx &lt; y \n\n[1] TRUE\n\n20 &lt;= 20\n\n[1] TRUE\n\n\nВосклицательный знак означает логическое НЕ (отрицание):\n\n!TRUE \n\n[1] FALSE\n\n!FALSE\n\n[1] TRUE"
  },
  {
    "objectID": "lecture1.html#логическое-и-и-логическое-или",
    "href": "lecture1.html#логическое-и-и-логическое-или",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Логическое И и логическое ИЛИ",
    "text": "Логическое И и логическое ИЛИ\nЛогическое И: выдаст TRUE, если все значения TRUE\n\nlogical1 & logical2\n\n[1] FALSE\n\n\nЛогическое ИЛИ: будет TRUE, если хотя бы одно из значений TRUE\n\nlogical1 | logical2\n\n[1] TRUE"
  },
  {
    "objectID": "lecture1.html#векторы",
    "href": "lecture1.html#векторы",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Векторы",
    "text": "Векторы\nВекторы являются ключевым типом данных в R, на основе которых строятся более сложные структуры данных. Скаляры (одиночные значения) являются векторами длиной 1.\n\nВектор - набор данных одного типа. В R существует 4 основных часто использующихся типов векторов.\nОсновные типы векторов:\n\n\nЛогические, logical: TRUE, FALSE\nЦелочисленные, integer: 1L, 190L\nДробные, double или числа с плавающей точкой: -1.5, 0.05, 5. Еще есть Inf, -Inf, NaN.\nСтроковые, character: 'Hello world', 'character'\n\n\n\n\n\n\n\nЦелочисленные вектора сопровождаются знаком L и не содержат дробной части"
  },
  {
    "objectID": "lecture1.html#создание-векторов",
    "href": "lecture1.html#создание-векторов",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Создание векторов",
    "text": "Создание векторов\n\nс помощью функции c(). Например: x &lt;- c(5, 4, 5, 3, 2).\ngene_names &lt;- c('ARR1', 'ARF19', 'WOX5')\nс помощью двоеточия :, чтобы создавать набор чисел по порядку с шагом 1. Например:\n\n16:30\n\n [1] 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30\n\n\nс помощью seq(), если нужна последовательность чисел, с шагом, отличным от единицы\n\nseq(from = 2, to = 20, by = 2)\n\n [1]  2  4  6  8 10 12 14 16 18 20\n\n\nс помощью rep() для создания повторяющихся элементов:\n\nrep(c(1:3, 5), times = 3)\n\n [1] 1 2 3 5 1 2 3 5 1 2 3 5"
  },
  {
    "objectID": "lecture1.html#индексация-векторов",
    "href": "lecture1.html#индексация-векторов",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Индексация векторов",
    "text": "Индексация векторов\nВ R индексация начинается с единицы (по-человечески). Для индексации используются квадратные скобки:\n\nsample_vector &lt;- 11:20\nsample_vector[1] # извлечь первый элемент вектора\n\n[1] 11\n\n\nДля извлечения нескольких элементов вектора в качестве индекса используется тоже вектор:\n\nsample_vector[2:5] # извлечь элементы со второго по пятый\n\n[1] 12 13 14 15\n\nsample_vector[c(3:6, 1, 10)] # извлечь элементы с третьего по шестой, первый и десятый\n\n[1] 13 14 15 16 11 20"
  },
  {
    "objectID": "lecture1.html#индексация-векторов-1",
    "href": "lecture1.html#индексация-векторов-1",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Индексация векторов",
    "text": "Индексация векторов\nМожно с помощью индексации заменять элементы:\n\nsample_vector[2] &lt;- 0\nsample_vector\n\n [1] 11  0 13 14 15 16 17 18 19 20\n\n\n\n\n\n\n\n\nTip\n\n\nКруглые скобки используются при работе с функциями, квадратные при индексации"
  },
  {
    "objectID": "lecture1.html#индексация-векторов-с-помощью-условия",
    "href": "lecture1.html#индексация-векторов-с-помощью-условия",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Индексация векторов с помощью условия",
    "text": "Индексация векторов с помощью условия\nКроме индексации по номеру, можно извлечь элементы вектора, соответствующие какому-либо условию.\nНапример, извлечь все значения, которые больше или равны нулю вектора x\n\nx &lt;- -3:3\nx\n\n[1] -3 -2 -1  0  1  2  3\n\n\nСначала используем условие:\n\nx &gt;= 0\n\n[1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE\n\n\nПолучаем логический вектор, который можно использовать как индекс для отбора нужных элементов x\n\nx[x &gt;= 0]\n\n[1] 0 1 2 3"
  },
  {
    "objectID": "lecture1.html#индексация-векторов-проверка-на-четность",
    "href": "lecture1.html#индексация-векторов-проверка-на-четность",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Индексация векторов: проверка на четность",
    "text": "Индексация векторов: проверка на четность\n\n\nДопустим, у нас есть вектор vect_for_even\n\nvect_for_even &lt;- sample(1:100, 10)\nvect_for_even\n\n [1] 28 80 21 71 22 13  6 20 30 17\n\n\nЗадача вывести все четные элементы, используя знания об индексации векторов. Оператор остатка от деления: %%\nЭто решается без циклов. Сначала делаем проверку условия, что остаток от деления на два каждого элемента равен нулю:\n\nvect_for_even %% 2 == 0\n\n [1]  TRUE  TRUE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE\n\n\nДалее используем полученный логический вектор в качестве индекса к исходному:\n\nvect_for_even[vect_for_even %% 2 == 0]\n\n[1] 28 80 22  6 20 30"
  },
  {
    "objectID": "lecture1.html#динамическая-нестрогая-типизация",
    "href": "lecture1.html#динамическая-нестрогая-типизация",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Динамическая нестрогая типизация",
    "text": "Динамическая нестрогая типизация\n\n\n\nДинамическая: не нужно при создании вектора указывать его тип, как бывает в языках со статичной типизацией. Также тип вектора может поменяться в процессе кода:\n\nvect &lt;- seq(3, 11, 2)\nvect\n\n[1]  3  5  7  9 11\n\nvect &lt;- 'Hello world'\n\nНестрогая (слабая, weak): происходит неявное приведение типов\n\n\n\n\n\n\n\n\n\n\n\nR на этой картинке должен быть в левом нижнем углу"
  },
  {
    "objectID": "lecture1.html#неявное-приведение-типов",
    "href": "lecture1.html#неявное-приведение-типов",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Неявное приведение типов",
    "text": "Неявное приведение типов\n\n\nВекторы в R по определению могут быть только одного типа. Что произойдет, если мы попытаемся объединить в одном векторе элементы разных типов?\nНапример так:\n\nx &lt;- c(10, TRUE, FALSE)\n\nБудет ли ошибка или каким-то образом произойдет объединение?\nОтвет:\n\nx\n\n[1] 10  1  0\n\n\nПроизошло неявное приведение типов (implicit coercion): логический тип превратился в числа, TRUE -&gt; 1, FALSE -&gt; 0"
  },
  {
    "objectID": "lecture1.html#порядок-неявного-приведения-типов",
    "href": "lecture1.html#порядок-неявного-приведения-типов",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Порядок неявного приведения типов",
    "text": "Порядок неявного приведения типов\nЛогика порядка приведения типов: от менее общего к более общему\nlogical -&gt; integer -&gt; numeric -&gt; character\nЧасто происходит превращение числового вектора в строку.\nПолезный пример неявного приведения типов: подсчет суммы истинных значений логического вектора\n\nsum(1:10 &gt; 5)\n\n[1] 5\n\nset.seed(1)\np_val &lt;- c(0.03, sample(seq(0.00001, 1, length.out = 100), 10))\np_val\n\n [1] 0.0300000 0.6767709 0.3838445 0.0000100 0.3333400 0.8686882 0.4242482\n [8] 0.1313218 0.8181836 0.5858627 0.5050555\n\nsum(p_val &lt; 0.05)\n\n[1] 2"
  },
  {
    "objectID": "lecture1.html#неявное-приведение-типов-иллюстрация",
    "href": "lecture1.html#неявное-приведение-типов-иллюстрация",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Неявное приведение типов: иллюстрация",
    "text": "Неявное приведение типов: иллюстрация\n\n\nc(1, 2, 3, 4, 5, '6')\n\n[1] \"1\" \"2\" \"3\" \"4\" \"5\" \"6\""
  },
  {
    "objectID": "lecture1.html#проверка-типа-вектора",
    "href": "lecture1.html#проверка-типа-вектора",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Проверка типа вектора",
    "text": "Проверка типа вектора\nЧтобы проверить тип вектора, можно использовать функцию class():\n\nx &lt;- c(1, 2, 3, 4, 5, '6')\nclass(x)\n\n[1] \"character\"\n\n\nТакже можно использовать функции проверки вектора на нужный тип: is.numeric(), is.character(), is.logical()\n\nis.numeric(x)\n\n[1] FALSE\n\nis.character(x)\n\n[1] TRUE\n\n\n\n\n\n\n\n\nЧтобы ознакомиться со списком функций is.* можно набрать is. в консоли и нажать Tab"
  },
  {
    "objectID": "lecture1.html#явное-приведение-типов",
    "href": "lecture1.html#явное-приведение-типов",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Явное приведение типов",
    "text": "Явное приведение типов\nЧтобы превратить вектор в нужный тип можно использовать функции: as.numeric(), as.character(), as.logical()\n\nx\n\n[1] \"1\" \"2\" \"3\" \"4\" \"5\" \"6\"\n\nas.numeric(x)\n\n[1] 1 2 3 4 5 6\n\n\nСоздадим вектор, который содержит строки и превратим в numeric обратно\n\nchar_vector &lt;- c(1:6, 'seven')\nchar_vector\n\n[1] \"1\"     \"2\"     \"3\"     \"4\"     \"5\"     \"6\"     \"seven\"\n\nas.numeric(char_vector)\n\n[1]  1  2  3  4  5  6 NA"
  },
  {
    "objectID": "lecture1.html#пропущенные-значения",
    "href": "lecture1.html#пропущенные-значения",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Пропущенные значения",
    "text": "Пропущенные значения\nПри работе с данными могут быть пропущенные значения в силу разных причин. В R обозначается NA - Not Available\n\nvector_missed &lt;- c(1:10, NA)\nvector_missed\n\n [1]  1  2  3  4  5  6  7  8  9 10 NA\n\n\nПроблема пропущенных значений: неопределенность “заражает”\n\nsum(vector_missed)\n\n[1] NA\n\nmean(vector_missed)\n\n[1] NA\n\n\nАргумент na.rm - способ вычислить среднее (сумму и тп) без учета пропущенных значений\n\nmean(vector_missed, na.rm = TRUE)\n\n[1] 5.5"
  },
  {
    "objectID": "lecture1.html#как-находить-пропущенные-значения",
    "href": "lecture1.html#как-находить-пропущенные-значения",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Как находить пропущенные значения?",
    "text": "Как находить пропущенные значения?\n\n\nДавайте попробуем сравнить значения нашего вектора с NA\n\nvector_missed == NA\n\n [1] NA NA NA NA NA NA NA NA NA NA NA\n\n\nОй\nПочему в сравнении NA == NA получается NA?\n\nNA == NA\n\n[1] NA\n\n\nПропущенное значение - это отсутствие информации о чем-либо, следовательно, мы не можем сделать вывод, является ли отсутствие информации равным другому отсутствию."
  },
  {
    "objectID": "lecture1.html#для-выявления-пропущенных-значений-используем-функцию-is.na",
    "href": "lecture1.html#для-выявления-пропущенных-значений-используем-функцию-is.na",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Для выявления пропущенных значений используем функцию is.na()",
    "text": "Для выявления пропущенных значений используем функцию is.na()\n\nis.na(vector_missed)\n\n [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE\n\n\nТеперь с помощью логического отрицания (NOT, !) этого вектора можно отобрать не-пропущенные элементы:\n\n!is.na(vector_missed)\n\n [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE\n\nvector_missed[!is.na(vector_missed)]\n\n [1]  1  2  3  4  5  6  7  8  9 10\n\n\nПосле этого можно делать интересующие операции над этим вектором, уже не беспокоясь о пропущенных значениях."
  },
  {
    "objectID": "lecture1.html#чек-лист-что-нужно-знать-после-лекции",
    "href": "lecture1.html#чек-лист-что-нужно-знать-после-лекции",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Чек-лист, что нужно знать после лекции",
    "text": "Чек-лист, что нужно знать после лекции\n\nЧто такое переменные, как их создавать\nКак проверять переменные на равенство/неравенство, больше/меньше\nПравила индексации векторов\nНеявное приведение типов\nРабота с пропущенными значениями"
  },
  {
    "objectID": "lecture1.html#вопросы",
    "href": "lecture1.html#вопросы",
    "title": "R и статистика в селекции: лекция 1",
    "section": "Вопросы?",
    "text": "Вопросы?\n\n\nПодписывайтесь на телеграм-канал о статистике:"
  },
  {
    "objectID": "lecture4.html#данные-для-работы",
    "href": "lecture4.html#данные-для-работы",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Данные для работы",
    "text": "Данные для работы\n\nlibrary(tidyverse) # для загрузки набора пакетов для анализа данных\n# library(ggplot2) # для загрузки ggplot2\nlibrary(readxl)\ndf &lt;- read_xlsx('data/sa.xlsx') %&gt;% \n  janitor::clean_names() # для синтаксически правильных названий колонок\nstr(df)\n\ntibble [66 × 6] (S3: tbl_df/tbl/data.frame)\n $ variety: chr [1:66] \"Сорт1\" \"Сорт1\" \"Сорт1\" \"Сорт1\" ...\n $ height : num [1:66] 175 193 188 176 182 161 165 173 180 180 ...\n $ cl     : num [1:66] 49 58 43 43 38 40 43 38 42 43 ...\n $ pcl    : num [1:66] 79 98 81 59 87 73 79 73 79 72 ...\n $ sp     : num [1:66] 19.2 20.5 30.5 19.2 21.7 24.7 28.5 27.5 23 16 ...\n $ mass   : num [1:66] 30.4 26.6 32.6 10.6 14.8 16.4 14.4 19.5 41.2 16.4 ...\n\n\nvariety – сорт, height – высота растений, mass – масса, cl – длина центрального соцветия, pcl – число стручков на соцветии, sp – количество семян в стручке.\nКакого типа переменные в данных?\n\nvariety – качественная переменная, height, mass – количественные непрерывные, cl, pcl, sp – количественные дискретные."
  },
  {
    "objectID": "lecture4.html#план-лекции",
    "href": "lecture4.html#план-лекции",
    "title": "R и статистика в селекции: лекция 4",
    "section": "План лекции",
    "text": "План лекции\n\nВиды графиков.\nНемного про способы визуализации в base R.\nВведение в ggplot2, из чего состоит грамматика графики: aes, geoms, scales, theme.\nОсновные геомы.\nПример построения графика с помощью ggplot2"
  },
  {
    "objectID": "lecture4.html#какие-можно-вспомнить-виды-графиков",
    "href": "lecture4.html#какие-можно-вспомнить-виды-графиков",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Какие можно вспомнить виды графиков?",
    "text": "Какие можно вспомнить виды графиков?\n\n\nДиаграмма рассеяния (scatterplot)\nГистограмма (histogram)\nБарплот (barplot)\n\n\n\n\n\n\nЧем барплот отличается от гистограммы?\n\n\n\n\n\n\n\n\n\nГистограммы для непрерывных величин, а барплоты для категориальных.\n\n\n\nБоксплот (boxplot)\nСкрипичная диаграмма (violin plot)\nPie chart (не рекомендуется)\nДиаграмма Венна\nHeatmap, density plot, upset, flowchart и много чего еще…"
  },
  {
    "objectID": "lecture4.html#диаграмма-рассеяния-с-помощью-функции-plot",
    "href": "lecture4.html#диаграмма-рассеяния-с-помощью-функции-plot",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Диаграмма рассеяния с помощью функции plot()",
    "text": "Диаграмма рассеяния с помощью функции plot()\nФункция plot() принимает на вход разные входные данные, начнем с колонки height датасета df.\n\n\nplot(df$height)\n\n\n\n\n\n\nЗдесь по оси X - порядковый номер элемента в исходном датафрейме, по Y - значение height.\n\n\n\n\n\n\nСинтаксис df$height позволяет извлечь одну колонку датафрейма в виде вектора."
  },
  {
    "objectID": "lecture4.html#диаграмма-рассеяния-с-помощью-функции-plot-1",
    "href": "lecture4.html#диаграмма-рассеяния-с-помощью-функции-plot-1",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Диаграмма рассеяния с помощью функции plot()",
    "text": "Диаграмма рассеяния с помощью функции plot()\nОтрисуем зависимость высоты height юнитов от массы mass. Как думаете, какую мы ожидаем зависимость?\nТочка соответствует каждому растению и его параметрам.\n\n\nplot(df$height, df$mass)\n\n\n\n\n\n\n\nМы наблюдаем положительную зависимость между высотой и массой."
  },
  {
    "objectID": "lecture4.html#гистограммы-histogram",
    "href": "lecture4.html#гистограммы-histogram",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Гистограммы (histogram)",
    "text": "Гистограммы (histogram)\nОтрисуем гистограмму по колонке height датасета df.\n\n\nhist(df$height)\n\n\n\n\n\n\nЧто значат столбики гистограммы?"
  },
  {
    "objectID": "lecture4.html#гистограммы-histogram-1",
    "href": "lecture4.html#гистограммы-histogram-1",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Гистограммы (histogram)",
    "text": "Гистограммы (histogram)\nМожно подкрасить столбики.\n\n\nhist(df$height, \ncol=\"#fdae61\", border=\"red3\")\n\n\n\n\n\n\nЦвета можно задавать в виде названий или RGB-кодов."
  },
  {
    "objectID": "lecture4.html#боксплоты",
    "href": "lecture4.html#боксплоты",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Боксплоты",
    "text": "Боксплоты\n\n\nboxplot(df$height)"
  },
  {
    "objectID": "lecture4.html#боксплоты-по-категориям",
    "href": "lecture4.html#боксплоты-по-категориям",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Боксплоты по категориям",
    "text": "Боксплоты по категориям\nЧерез синтаксис формулы (~), где слева количественная переменная, справа качественная.\n\n\nboxplot(height ~ variety, df)"
  },
  {
    "objectID": "lecture4.html#ggplot2---grammar-of-graphics-plot",
    "href": "lecture4.html#ggplot2---grammar-of-graphics-plot",
    "title": "R и статистика в селекции: лекция 4",
    "section": "ggplot2 - grammar of graphics plot",
    "text": "ggplot2 - grammar of graphics plot\nПодход к построению графиков в ggplot2 принципиально отличается от обычных пакетов визуализации (matplotlib, seaborn в питоне).\n\n\nФишка ggplot2 состоит в применении языка грамматики графики - набора правил для построения графиков.\nТакой подход дает огромную гибкость и возможность создания и кастомизации практически любого графика. Пакет опирается на книгу The Grammar of Graphics (Leland Wilkinson)."
  },
  {
    "objectID": "lecture4.html#слои-в-ggplot2",
    "href": "lecture4.html#слои-в-ggplot2",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Слои в ggplot2",
    "text": "Слои в ggplot2\n\n\nКомпоненты графика:\n\nданные (data)\nаэстетики (aes)\nгеомы (geom)\nшкалы (scales)\nразбивка facets\nоформление (theme)"
  },
  {
    "objectID": "lecture4.html#начнем-с-создания-основы-графика",
    "href": "lecture4.html#начнем-с-создания-основы-графика",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Начнем с создания основы графика",
    "text": "Начнем с создания основы графика\n\n\nggplot(df)\n\n\n\n\n\n\nЧасто пишут с помощью пайпов: df %&gt;% ggplot(), однако сейчас не будем усложнять."
  },
  {
    "objectID": "lecture4.html#добавим-aes",
    "href": "lecture4.html#добавим-aes",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Добавим aes()",
    "text": "Добавим aes()\n\n\nggplot(df, \n       aes(x = height, y = mass))\n\n\n\n\n\n\naes() отражает, какие переменные и по какой оси собираемся использовать в графике (X, Y, цвет, размер). Здесь мы прописали, что по X будет height, по Y mass.\nТеперь нужно задать, в виде какого геома переменные будут отражены на графике."
  },
  {
    "objectID": "lecture4.html#добавим-geom_",
    "href": "lecture4.html#добавим-geom_",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Добавим geom_",
    "text": "Добавим geom_\n\n\nggplot(df, aes(x = height, y = mass))+\n  geom_point(size = 3)\n\n\n\n\n\n\ngeom_point() - отрисовывает переменные, поданные в аэстетики (aes), в виде точек. Получилась обычная диаграмма рассеяния!"
  },
  {
    "objectID": "lecture4.html#добавим-регрессионную-линию-с-помощью-geom_smooth",
    "href": "lecture4.html#добавим-регрессионную-линию-с-помощью-geom_smooth",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Добавим регрессионную линию с помощью geom_smooth()",
    "text": "Добавим регрессионную линию с помощью geom_smooth()\n\n\nggplot(df, aes(x = height, y = mass))+\n  geom_point(size = 3)+\n  geom_smooth()\n\n\n\n\n\n\nПо умолчанию линия не прямая, пытается максимально приблизить точки."
  },
  {
    "objectID": "lecture4.html#добавим-регрессионную-прямую-с-помощью-geom_smoothmethod-lm",
    "href": "lecture4.html#добавим-регрессионную-прямую-с-помощью-geom_smoothmethod-lm",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Добавим регрессионную прямую с помощью geom_smooth(method = 'lm')",
    "text": "Добавим регрессионную прямую с помощью geom_smooth(method = 'lm')\n\n\nggplot(df, aes(x = height, y = mass))+\n  geom_point(size = 3)+\n  geom_smooth(method = 'lm')\n\n\n\n\n\n\nВ этом случае строится классическая линейная регрессия."
  },
  {
    "objectID": "lecture4.html#добавим-variety-растений-с-помощью-цвета-color-в-aes",
    "href": "lecture4.html#добавим-variety-растений-с-помощью-цвета-color-в-aes",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Добавим variety растений с помощью цвета color в aes()",
    "text": "Добавим variety растений с помощью цвета color в aes()\n\n\n\naes(), которые прописаны в функции ggplot будут применены для всех дальнейших геомов. aes() в конкретном геоме будут применены только для этого геома.\n\n\n\n\n\nggplot(df, aes(x = height, y = mass, color = variety))+\n  geom_point(size = 3)+\n  geom_smooth(method = 'lm')\n\n\n\n\n\n\nПолучили регрессионную прямую для каждого сорта в отдельности."
  },
  {
    "objectID": "lecture4.html#чтобы-задать-отдельно-аэстетику-в-конкретном-геоме",
    "href": "lecture4.html#чтобы-задать-отдельно-аэстетику-в-конкретном-геоме",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Чтобы задать отдельно аэстетику в конкретном геоме",
    "text": "Чтобы задать отдельно аэстетику в конкретном геоме\n\n\nggplot(df, aes(x = height, y = mass))+\n  geom_point(aes(color = variety), size = 3)+\n  geom_smooth(method = 'lm')\n\n\n\n\n\n\nСоответственно, цвет в виде сорта отразился только для точек, а регрессионная линия с помощью geom_smooth() применена для всего графика в целом, без разбивки на сорт."
  },
  {
    "objectID": "lecture4.html#добавить-прозрачность-для-точек-с-помощью-alpha",
    "href": "lecture4.html#добавить-прозрачность-для-точек-с-помощью-alpha",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Добавить прозрачность для точек с помощью alpha",
    "text": "Добавить прозрачность для точек с помощью alpha\n\n\nggplot(df, aes(x = height, y = mass))+\n  geom_point(aes(color = variety), \n             size = 3, alpha = 0.8)+\n  geom_smooth(method = 'lm', color = 'gray30')\n\n\n\n\n\n\nМожно усложнять график, например добавить форму (shape) для точек и отразить другие качественные переменные. Однако в нашем случае другие переменные у нас количественные.\nКак же можно отразить несколько (&gt;2) количественных переменных на одном графике?"
  },
  {
    "objectID": "lecture4.html#как-делать-не-надо",
    "href": "lecture4.html#как-делать-не-надо",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Как делать не надо",
    "text": "Как делать не надо\n3D-график является плохой практикой и не рекомендуется к использованию.\n\nКак вы думаете, почему?"
  },
  {
    "objectID": "lecture4.html#использование-других-параметров-точек-в-качестве-дополнительной-оси",
    "href": "lecture4.html#использование-других-параметров-точек-в-качестве-дополнительной-оси",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Использование других параметров точек в качестве дополнительной оси",
    "text": "Использование других параметров точек в качестве дополнительной оси\nМы можем использовать цвет, размер точек для отражения дополнительных переменных.\n\n\nggplot(df, aes(x = height, y = mass, color = variety))+\n  geom_point(aes(size = cl))"
  },
  {
    "objectID": "lecture4.html#используем-цвет-в-виде-количественной-оси-и-форму-для-качественной",
    "href": "lecture4.html#используем-цвет-в-виде-количественной-оси-и-форму-для-качественной",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Используем цвет в виде количественной оси и форму для качественной",
    "text": "Используем цвет в виде количественной оси и форму для качественной\n\n\nggplot(df, aes(x = height, y = mass, shape = variety))+\n  geom_point(aes(size = cl, color = sp))\n\n\n\n\n\n\nВозможно получилось не очень информативно, лучше разделить по сортам (variety) на фасетки (чуть дальше)."
  },
  {
    "objectID": "lecture4.html#барплот---geom_bar",
    "href": "lecture4.html#барплот---geom_bar",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Барплот - geom_bar()",
    "text": "Барплот - geom_bar()\nСтандартная задача отрисовать средние и пределы погрешности для статьи или презентации. Для этого нам нужно преобразовать исходные данные – посчитать среднее и стандартное отклонение. Используем tidyverse-подход group_by() + summarise().\n\ndf_height &lt;- df %&gt;% \n  group_by(variety) %&gt;% \n  summarise(mean = mean(height, na.rm = TRUE), \n            sd = sd(height, na.rm = TRUE))\ndf_height\n\n# A tibble: 3 × 3\n  variety  mean    sd\n  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1 Сорт1    171.  12.8\n2 Сорт2    172.  16.5\n3 Сорт3    173.  14.5"
  },
  {
    "objectID": "lecture4.html#барплот---geom_bar-1",
    "href": "lecture4.html#барплот---geom_bar-1",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Барплот - geom_bar()",
    "text": "Барплот - geom_bar()\n\n\ndf_height %&gt;% \n  ggplot(aes(x = variety, y = mean))+\n  geom_bar(stat = 'identity')\n\n\n\n\n\n\nТоже самое, что и\n\nggplot(df_height, aes(x = variety, y = mean))+\n  geom_bar(stat = 'identity')"
  },
  {
    "objectID": "lecture4.html#барплот---geom_bar-с-пределами-погрешностей",
    "href": "lecture4.html#барплот---geom_bar-с-пределами-погрешностей",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Барплот - geom_bar() с пределами погрешностей",
    "text": "Барплот - geom_bar() с пределами погрешностей\nПределы погрешности рисуются с помощью функции geom_errorbar()\n\n\ndf_height %&gt;% \n  ggplot(aes(x = variety, y = mean))+\n  geom_bar(stat = 'identity')+\n  geom_errorbar(aes(ymin = mean - sd, \n                    ymax = mean + sd), width = 0.2)\n\n\n\n\n\n\nСредние примерно равны, стандартные отклонения получились относительно небольшими."
  },
  {
    "objectID": "lecture4.html#боксплот---geom_boxplot",
    "href": "lecture4.html#боксплот---geom_boxplot",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Боксплот - geom_boxplot()",
    "text": "Боксплот - geom_boxplot()\n\n\ndf %&gt;% \n  ggplot(aes(variety, height))+\n  geom_boxplot()\n\n\n\n\n\n\nЧто отражает боксплот?"
  },
  {
    "objectID": "lecture4.html#боксплот",
    "href": "lecture4.html#боксплот",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Боксплот",
    "text": "Боксплот"
  },
  {
    "objectID": "lecture4.html#расширения-ggplot2-для-возможности-отражать-значимости",
    "href": "lecture4.html#расширения-ggplot2-для-возможности-отражать-значимости",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Расширения ggplot2 для возможности отражать значимости",
    "text": "Расширения ggplot2 для возможности отражать значимости\nРасширение ggpubr, а с полным списком расширений можно ознакомиться здесь."
  },
  {
    "objectID": "lecture4.html#боксплот-с-отражением-конкретных-наблюдений",
    "href": "lecture4.html#боксплот-с-отражением-конкретных-наблюдений",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Боксплот с отражением конкретных наблюдений",
    "text": "Боксплот с отражением конкретных наблюдений\n\n\ndf %&gt;% \n  ggplot(aes(variety, height))+\n  geom_boxplot()+\n  geom_jitter(aes(color = variety))+\n  theme_classic()"
  },
  {
    "objectID": "lecture4.html#violin-plot-скрипичная-диаграмма---geom_violin",
    "href": "lecture4.html#violin-plot-скрипичная-диаграмма---geom_violin",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Violin plot (скрипичная диаграмма) - geom_violin()",
    "text": "Violin plot (скрипичная диаграмма) - geom_violin()\n\n\ndf %&gt;% \n  ggplot(aes(variety, height))+\n  geom_violin()\n\n\n\n\n\n\nСкрипичные диаграммы содержат больше информации чем боксплоты, однако в среднем сложнее для интерпретации."
  },
  {
    "objectID": "lecture4.html#violin-boxplot",
    "href": "lecture4.html#violin-boxplot",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Violin + boxplot",
    "text": "Violin + boxplot\n\n\ndf %&gt;% \n  ggplot(aes(variety, height))+\n  geom_violin()+\n  geom_boxplot(width = 0.2)"
  },
  {
    "objectID": "lecture4.html#таблица-по-основным-геомам",
    "href": "lecture4.html#таблица-по-основным-геомам",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Таблица по основным геомам",
    "text": "Таблица по основным геомам\n\n\n\n\n\n\n\n\nНазвание геома\nПеревод\nПрименение\n\n\n\n\ngeom_point()\nТочечная диаграмма\nДиаграмма рассеяния\n\n\ngeom_bar()\nБарплот\nДля сравнения групп между собой\n\n\ngeom_histogram()\nГистограмма\nДля количественных переменных\n\n\ngeom_errorbar()\nПределы погрешностей\nОтрисовка “усов”\n\n\ngeom_boxplot()\nБоксплот\nДля сравнения групп между собой\n\n\ngeom_vioin()\nСкрипичная диаграмма\nДля сравнения групп между собой\n\n\ngeom_smooth()\nРегрессионная линия\nДля регрессии"
  },
  {
    "objectID": "lecture4.html#таблица-с-основными-параметрами-геомов",
    "href": "lecture4.html#таблица-с-основными-параметрами-геомов",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Таблица с основными параметрами геомов",
    "text": "Таблица с основными параметрами геомов\n\n\n\nНазвание\nЧто отражает\n\n\n\n\ncolor\nцвет точек, обводка у столбцов, боксплотов и тп\n\n\nfill\nзаливка столбцов, боксплотов\n\n\nsize\nразмер геома\n\n\nshape\nформа точек\n\n\nalpha\nпрозрачность геома\n\n\n\nВсе эти параметры можно использовать как статично (например, geom_point(size = 3)), так и в качестве аэстетики, то есть другой переменной, например показать зависимость размера точек от другой переменной: geom_point(aes(size = cl))."
  },
  {
    "objectID": "lecture4.html#работа-со-шкалами",
    "href": "lecture4.html#работа-со-шкалами",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Работа со шкалами",
    "text": "Работа со шкалами\nЭто различные scale_x_continuous(), scale_y_continuous(), scale_color_manual(), выбор зависит от типа шкалы на графике.\nПозволяют тонко настраивать параметры конкретной шкалы: лимиты и шаг засечек на графике, название оси, цвет в случае цветовой шкалы.\n\n\nggplot(df, aes(x = height, y = mass, color = variety))+\n  geom_point(size = 3)+\n  scale_y_continuous(limits = c(0,40), \n                     breaks = seq(0, 40, 5),\n                     name = 'Масса')"
  },
  {
    "objectID": "lecture4.html#работа-с-цветовой-шкалой",
    "href": "lecture4.html#работа-с-цветовой-шкалой",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Работа с цветовой шкалой",
    "text": "Работа с цветовой шкалой\nХорошие цветовые сочетания можно посмотреть здесь\n\n\nggplot(df, aes(x = height, y = mass, color = variety))+\n  geom_point(size = 3)+\n  scale_y_continuous(limits = c(0,40), \n                     breaks = seq(0, 40, 5),\n                     name = 'Масса')+\n  scale_color_manual(values = c('#f1b6da','#b8e186','#4dac26'))"
  },
  {
    "objectID": "lecture4.html#работа-с-фасетами",
    "href": "lecture4.html#работа-с-фасетами",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Работа с фасетами",
    "text": "Работа с фасетами\nЕсть функции facet_grid() и facet_wrap(), рекомендую последнюю для разбивки графика на “фасетки” по категориальным переменным.\n\n\npl &lt;- df %&gt;%\n  ggplot(aes(height, mass, color = cl))+\n  geom_point()+\n  facet_wrap(~variety)\npl"
  },
  {
    "objectID": "lecture4.html#работа-с-фасетами-и-цвет-и-размер-как-оси-для-количественных-переменных",
    "href": "lecture4.html#работа-с-фасетами-и-цвет-и-размер-как-оси-для-количественных-переменных",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Работа с фасетами и цвет и размер как оси для количественных переменных",
    "text": "Работа с фасетами и цвет и размер как оси для количественных переменных\n\n\ndf %&gt;%\n  ggplot(aes(height, mass, color = cl))+\n  geom_point(aes(size = pcl))+\n  facet_wrap(~variety)"
  },
  {
    "objectID": "lecture4.html#изменение-внешнего-вида-графика",
    "href": "lecture4.html#изменение-внешнего-вида-графика",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Изменение внешнего вида графика",
    "text": "Изменение внешнего вида графика\nМожно использовать встроенные темы, например theme_bw(), theme_classic().\n\n\npl +\n  theme_bw()"
  },
  {
    "objectID": "lecture4.html#изменение-визуального-отображения-графика",
    "href": "lecture4.html#изменение-визуального-отображения-графика",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Изменение визуального отображения графика",
    "text": "Изменение визуального отображения графика\nСамостоятельно настраивать элементы графика нужно в функции theme()\nНапример: увеличим шрифт подписей оси, изменим цвет, поставим заголовок на центр\n\n\npl +\n  ggtitle('Зависимость высоты и массы для разных сортов')+\n  theme(axis.text = element_text(size = 14),\n        axis.title = element_text(size = 16),\n        plot.title = element_text(hjust = 0.5, color = 'blue'))\n\n\n\n\n\n\nВсе параметры для изменения темы можно посмотреть в справке: ?theme"
  },
  {
    "objectID": "lecture4.html#сохранение-графика",
    "href": "lecture4.html#сохранение-графика",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Сохранение графика",
    "text": "Сохранение графика\n\nggsave('plots/plot.png', pl, dpi = 300)\n\nТакже можно экспортировать в pdf и задавать желаемые размеры графика."
  },
  {
    "objectID": "lecture4.html#материалы-для-дальнейшего-изучения",
    "href": "lecture4.html#материалы-для-дальнейшего-изучения",
    "title": "R и статистика в селекции: лекция 4",
    "section": "Материалы для дальнейшего изучения",
    "text": "Материалы для дальнейшего изучения\n\nПонятная презентация мастер-класс по ggplot2\nОбзор расширений ggplot2\nВизуализация данных с помощью ggplot2(Мастицкий С.Э.)\nКнига ggplot2"
  },
  {
    "objectID": "lecture5.html#план-лекции",
    "href": "lecture5.html#план-лекции",
    "title": "R и статистика в селекции: лекция 5",
    "section": "План лекции",
    "text": "План лекции\n\nПроекты и организация работы в RStudio\nНормальное распределение и центральная предельная теорема\nАлгоритм статистического вывода\nРазбор алгоритма на примере теста Стьюдента\nТест Велча и ограничения теста Стьюдента\nТест Манна-Уитни"
  },
  {
    "objectID": "lecture5.html#нормальное-распределение",
    "href": "lecture5.html#нормальное-распределение",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Нормальное распределение",
    "text": "Нормальное распределение\nСимметричное, унимодальное, где отклонения от среднего подчиняются вероятностному закону.\n\nСтандартное нормальное распределение – нормальное распределение со средним 0 и дисперсией 1. Любое нормальное распределение можно привести к стандартному с помощью z-преобразования."
  },
  {
    "objectID": "lecture5.html#значение-центральной-предельной-теоремы",
    "href": "lecture5.html#значение-центральной-предельной-теоремы",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Значение центральной предельной теоремы",
    "text": "Значение центральной предельной теоремы\nМысленный эксперимент: многократно извлекаем выборки из генеральной совокупности, считаем средние по выборкам.\n\nsamp_means &lt;- replicate(1000, mean(rnorm(100, mean = 100, sd = 15)))  \nhist(samp_means, breaks = 30) \n\n\nРаспределение средних, извлеченных из нормального распределения, примерно нормальное. Это неудивительно, попробуем теперь в качестве генеральной совокупности использовать лог-нормальное распределение."
  },
  {
    "objectID": "lecture5.html#лог-нормальное-распределение",
    "href": "lecture5.html#лог-нормальное-распределение",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Лог-нормальное распределение",
    "text": "Лог-нормальное распределение\n\nhist(rlnorm(100), breaks = 30) \n\n\nРаспределение ассиметричное, однако как будут распределены выборочные средние?"
  },
  {
    "objectID": "lecture5.html#распределение-средних-лог-нормального-распределения",
    "href": "lecture5.html#распределение-средних-лог-нормального-распределения",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Распределение средних лог-нормального распределения",
    "text": "Распределение средних лог-нормального распределения\n\nsamp_means_log &lt;- replicate(1000, mean(rlnorm(100)))  \nhist(samp_means_log, breaks = 30)\n\n\nА вот распределение средних из изначально не-нормального распределение тоже похоже на нормальное распределение! Это получается благодаря центральной предельной теореме.\nШайни апп для центральной предельной теоремы"
  },
  {
    "objectID": "lecture5.html#алгоритм-статистического-вывода",
    "href": "lecture5.html#алгоритм-статистического-вывода",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Алгоритм статистического вывода",
    "text": "Алгоритм статистического вывода\n\nФормулировка нулевой и альтернативной гипотезы.\nВычисление тестовых статистик.\nПодсчет p-value как площади под кривой выборочного распределения тестовых статистик.\nВывод: отклоняем или не отклоняем нулевую гипотезу.\n\nРазберем на примере теста Стьюдента."
  },
  {
    "objectID": "lecture5.html#тест-стьюдента-или-t-test",
    "href": "lecture5.html#тест-стьюдента-или-t-test",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Тест Стьюдента или t-test",
    "text": "Тест Стьюдента или t-test\nИспользуется для сравнения двух выборок между собой, в случае когда мы не знаем стандартное отклонение генеральной совокупности (почти всегда). В результате мы оцениваем стандартное отклонение в генеральной совокупности на основе стандартного отклонения по выборке.\nЭто приводит к тому, что тестовая статистика уже не распределена нормально (как в z-тесте), а распределена согласно t-распределению. Статистика называется t-статистикой.\n\\[\nt = \\frac{\\overline{x} - \\mu} {s_x / \\sqrt{N}}\n\\]"
  },
  {
    "objectID": "lecture5.html#распределение-стьюдента-или-t-распределение",
    "href": "lecture5.html#распределение-стьюдента-или-t-распределение",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Распределение Стьюдента или t-распределение",
    "text": "Распределение Стьюдента или t-распределение\n\n\nt-распределение очень похоже на нормальное, также симметричное, унимодальное, но отклонения от среднего подчиняются немного другому вероятностному закону и зависят от размера выборки.\nt-распределение имеет параметр степеней свободы: размер выборки -1 и распределение имеет более “тяжелые” хвосты по сравнению с нормальным.\nПри размере выборке (и количеству степеней свободы), стремящемуся к бесконечности, t-распределение стремится к нормальному."
  },
  {
    "objectID": "lecture5.html#постановка-задачи",
    "href": "lecture5.html#постановка-задачи",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Постановка задачи",
    "text": "Постановка задачи\nУ нас есть две выборки, мы хотим сравнить средние, и сделать вывод, есть ли статистически значимые различия между ними. Для этого возьмем данные по урожайности растения сафлор.\n\n# install.packages('agridat')\nlibrary(agridat)\ndata(draper.safflower.uniformity)\ndf &lt;- draper.safflower.uniformity\nstr(df)\n\n'data.frame':   640 obs. of  4 variables:\n $ expt : Factor w/ 2 levels \"E4\",\"E5\": 2 2 2 2 2 2 2 2 2 2 ...\n $ row  : int  1 2 3 4 5 6 7 8 9 10 ...\n $ col  : int  1 1 1 1 1 1 1 1 1 1 ...\n $ yield: int  579 445 465 455 390 444 376 433 426 475 ...\n\n\nЗдесь два эксперимента: E4 и E5, которые отличались размером делянки. Сравним, есть ли различия в урожайности у двух групп.\nДля этого подходит двухвыборочный независимый тест Стьюдента."
  },
  {
    "objectID": "lecture5.html#посмотрим-на-данные",
    "href": "lecture5.html#посмотрим-на-данные",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Посмотрим на данные",
    "text": "Посмотрим на данные\n\n\nlibrary(tidyverse)\ndf %&gt;% \n  ggplot(aes(expt, yield))+\n  geom_boxplot()\n\n\n\n\n\n\nРазмер выборок:\n\nsummary(df$expt)\n\n E4  E5 \n340 300"
  },
  {
    "objectID": "lecture5.html#формулировка-нулевой-и-альтернативной-гипотезы",
    "href": "lecture5.html#формулировка-нулевой-и-альтернативной-гипотезы",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Формулировка нулевой и альтернативной гипотезы",
    "text": "Формулировка нулевой и альтернативной гипотезы\n- \\(H_0: \\mu_1 = \\mu_2\\) нулевая гипотеза, о том, что обе выборки взяты из одной генеральной совокупности (или из генеральных совокупностей с одинаковым средним) (урожайность одинакова вне зависимости от размера делянки).\n- \\(H_1: \\mu_1 \\neq \\mu_2\\) альтернативная гипотеза, о том, что выборки взяты из генеральных совокупностей с разным средним (урожайность различается).\nЗдесь \\(\\mu_1\\) – среднее генеральной совокупности для эксперимента Е4, \\(\\mu_2\\) – среднее генеральной совокупности для эксперимента E5."
  },
  {
    "objectID": "lecture5.html#вычисление-тестовой-статистики",
    "href": "lecture5.html#вычисление-тестовой-статистики",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Вычисление тестовой статистики",
    "text": "Вычисление тестовой статистики\nФормула расчета для двухвыборочного независимого теста Стьюдента:\n\\[\nt = \\frac{\\overline{X_1}-\\overline{X_2}}{s_x\\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}},s_x = \\sqrt{\\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}\n\\]\nПосчитаем с помощью функции t.test() и выберем только значение статистики:\n\nt_value &lt;- t.test(yield ~ expt, df, var.equal = TRUE)$statistic\nt_value\n\n        t \n-33.66189 \n\n\nt-статистика равна -33.66, чем она больше (по модулю), тем p-value будет ниже."
  },
  {
    "objectID": "lecture5.html#подсчет-p-value",
    "href": "lecture5.html#подсчет-p-value",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Подсчет p-value",
    "text": "Подсчет p-value\nОпределение: p-value – это вероятность получить такие же или еще более экстремальные значения тестовой статистики при условии верности нулевой гипотезы.\nРаспределение тестовой статистики – это t-распределение с \\(n_1 + n_2 - 2\\) степенями свободы, где \\(n_1\\), \\(n_2\\) – размер выборки 1 и размер выборки 2, соответственно.\n\nЗначение t-статистики очень большое, значит значение p-value очень маленькое."
  },
  {
    "objectID": "lecture5.html#подсчет-p-value-1",
    "href": "lecture5.html#подсчет-p-value-1",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Подсчет p-value",
    "text": "Подсчет p-value\nФункция pt() подсчитывает площадь под кривой распределения от \\(-\\infty\\) до t_value. Поскольку тест двусторонний, то надо умножить на 2.\n\npt(t_value, df = nrow(df) - 2, lower.tail = TRUE) * 2\n\n           t \n1.38818e-143 \n\n\nТеперь сравним с результатом теста t.test()\n\nt.test(yield ~ expt, df, var.equal = TRUE)$p.value\n\n[1] 1.38818e-143"
  },
  {
    "objectID": "lecture5.html#принятие-решения-о-нулевой-гипотезе",
    "href": "lecture5.html#принятие-решения-о-нулевой-гипотезе",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Принятие решения о нулевой гипотезе",
    "text": "Принятие решения о нулевой гипотезе\n\nt.test(yield ~ expt, df, var.equal = TRUE)\n\n\n    Two Sample t-test\n\ndata:  yield by expt\nt = -33.662, df = 638, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in means between group E4 and group E5 is not equal to 0\n95 percent confidence interval:\n -285.8747 -254.3598\nsample estimates:\nmean in group E4 mean in group E5 \n        215.1294         485.2467 \n\n\np-value &lt; 0.05 -&gt; следовательно отклоняем нулевую гипотезу о равенстве средних."
  },
  {
    "objectID": "lecture5.html#тест-стьюдента-и-тест-велча-welch",
    "href": "lecture5.html#тест-стьюдента-и-тест-велча-welch",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Тест Стьюдента и тест Велча (Welch)",
    "text": "Тест Стьюдента и тест Велча (Welch)\nНа самом деле по умолчанию в R запускается тест Велча, который устойчив к нарушению предположения о равенстве дисперсий.\nДля запуска теста Стьюдента мы использовали аргумент var.equal = TRUE, по умолчанию FALSE.\nРасчет теста Велча\n\nt.test(yield ~ expt, df)\n\n\n    Welch Two Sample t-test\n\ndata:  yield by expt\nt = -32.114, df = 373.4, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in means between group E4 and group E5 is not equal to 0\n95 percent confidence interval:\n -286.6566 -253.5779\nsample estimates:\nmean in group E4 mean in group E5 \n        215.1294         485.2467"
  },
  {
    "objectID": "lecture5.html#формула-теста-велча",
    "href": "lecture5.html#формула-теста-велча",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Формула теста Велча",
    "text": "Формула теста Велча\n\\[\nt = \\frac{\\overline{X}_1 - \\overline{X}_2}{\\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}}\n\\]\nКоличество степеней свободы:\n\\[\ndf = \\frac{(s_1^2/n_1 + s_2^2 / n_2)^2}{(s_1^2/n_1)^2/(n_1-1) + (s_2^2/n_2)^2/(n_2-1)}\n\\]\nПо умолчанию рекомендую считать именно тест Велча, потому что для случаев, где дисперсии двух выборок приблизительно равны, он не будет отличаться от теста Стьюдента, а при разных дисперсиях точнее."
  },
  {
    "objectID": "lecture5.html#ограничения-теста-стьюдента",
    "href": "lecture5.html#ограничения-теста-стьюдента",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Ограничения теста Стьюдента",
    "text": "Ограничения теста Стьюдента\n\n\nНезависимость наблюдений - очень важно.\nНормальность распределения - под вопросом.\nРавенство дисперсий - необязательно для теста Велча."
  },
  {
    "objectID": "lecture5.html#нужно-ли-нормальное-распределение-для-t-теста",
    "href": "lecture5.html#нужно-ли-нормальное-распределение-для-t-теста",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Нужно ли нормальное распределение для t-теста?",
    "text": "Нужно ли нормальное распределение для t-теста?\nДавайте сначала оценим вероятность ошибки первого рода, когда мы многократно (10000 раз) извлекаем две выборки объемом 30 значений из стандартного нормального распределения и сравниваем их t-тестом:\nГенеральная совокупность одинаковая, следовательно мы ожидаем найти отличия не более чем в 5% случаев.\n\nmean(replicate(10000, t.test(rnorm(30), rnorm(30))$p.value) &lt; 0.05)\n\n[1] 0.0491\n\n\nВероятность получить ошибку первого рода (то есть найти отличия, там где их на самом деле нет) примерно 0.05.\nСсылки: 1, 2."
  },
  {
    "objectID": "lecture5.html#теперь-такую-же-процедуру-для-логнормального-распределения",
    "href": "lecture5.html#теперь-такую-же-процедуру-для-логнормального-распределения",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Теперь такую же процедуру для логнормального распределения",
    "text": "Теперь такую же процедуру для логнормального распределения\nГенеральная совокупность одинаковая, следовательно мы ожидаем найти отличия не более чем в 5% случаев.\n\nmean(replicate(10000, t.test(rlnorm(30), rlnorm(30))$p.value) &lt; 0.05)\n\n[1] 0.0378\n\n\nВероятность ошибки первого рода даже меньше!\nЧто насчет графического способа определения нормальности распределения?"
  },
  {
    "objectID": "lecture5.html#попробуем-отрисовать-qqplot-для-нормального-распределения",
    "href": "lecture5.html#попробуем-отрисовать-qqplot-для-нормального-распределения",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Попробуем отрисовать qqplot для нормального распределения",
    "text": "Попробуем отрисовать qqplot для нормального распределения\nqqplot - quantile-quantile plot.\n\nlibrary(car)\nset.seed(50)\nsamp &lt;- rnorm(30)\nqqPlot(samp)\n\n\n[1] 26 24\n\n\nВ нормальном распределении точки должны располагаться на синей линии."
  },
  {
    "objectID": "lecture5.html#попробуем-отрисовать-гистограмму",
    "href": "lecture5.html#попробуем-отрисовать-гистограмму",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Попробуем отрисовать гистограмму",
    "text": "Попробуем отрисовать гистограмму\n\nhist(samp)\n\n\nВывод: не всегда графический способ позволяет определить принадлежность данных нормальному распределению, поскольку при малых объемах выборки даже настоящее нормальное распределение может не выглядеть как нормальное."
  },
  {
    "objectID": "lecture5.html#тест-шапиро-уилка-shapiro-wilk-для-проверки-на-нормальность",
    "href": "lecture5.html#тест-шапиро-уилка-shapiro-wilk-для-проверки-на-нормальность",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Тест Шапиро-Уилка (Shapiro-Wilk) для проверки на нормальность",
    "text": "Тест Шапиро-Уилка (Shapiro-Wilk) для проверки на нормальность\n\nshapiro.test(samp)\n\n\n    Shapiro-Wilk normality test\n\ndata:  samp\nW = 0.94952, p-value = 0.1641\n\n\nВ нашем случае p-value больше 0.05, что логично: мы взяли эту выборку именно из нормального распределения. Если p-value меньше уровня α, который у нас стандартно 0.05, то мы можем отвергнуть нулевую гипотезу о том, что выборка взята из нормального распределения.\n\n\n\n\n\n\nWarning\n\n\nОднако тест Шапиро-Уилка это такой же статистический тест, как и другие, следовательно, чем больше выборка, тем с большей вероятностью он найдет отклонения от нормальности."
  },
  {
    "objectID": "lecture5.html#непараметрические-тесты",
    "href": "lecture5.html#непараметрические-тесты",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Непараметрические тесты",
    "text": "Непараметрические тесты\nТем не менее, бывают ситуации, когда тест Стьюдента неприменим, например в случае явных выбросов. В таком случае можно использовать непараметрический аналог - тест Манна-Уитни.\nКроме того, непараметрические методы подходят для интервальных и ранговых шкал, где арифметическое среднее не имеет физического смысла.\nНепараметрические тесты не опираются на параметры заранее известных распределений (например нормального), следовательно, более устойчивы к нарушению предположений параметрических тестов."
  },
  {
    "objectID": "lecture5.html#тест-манна-уитни-mann-whitney-теория",
    "href": "lecture5.html#тест-манна-уитни-mann-whitney-теория",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Тест Манна-Уитни (Mann-Whitney): теория",
    "text": "Тест Манна-Уитни (Mann-Whitney): теория\n\\(H_0: P(A &gt; B) = 0.5\\) вероятность того, что случайное число из распределения A больше, чем случайное число из распределения B равно 50%.\n\\(H_1: P(A &gt; B) \\neq 0.5\\) вероятность, что случайное число из A больше чем B не равно 50%, следовательно распределения A и B отличаются сдвигом местоположения.\nИллюстрация:"
  },
  {
    "objectID": "lecture5.html#тест-манна-уитни-mann-whitney-формула",
    "href": "lecture5.html#тест-манна-уитни-mann-whitney-формула",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Тест Манна-Уитни (Mann-Whitney): формула",
    "text": "Тест Манна-Уитни (Mann-Whitney): формула\nЧисла из обеих выборок ранжируются, то есть расставляются по порядку и самому наименьшему числу присваивается ранг 1, следующему 2, и так далее. Затем вычисляется тестовая U-статистика.\nДля независимых выборок - функция wilcox.test(), синтаксис такой же как и для t.test():\n\nwilcox.test(yield ~ expt, df)\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  yield by expt\nW = 437, p-value &lt; 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n\n\np-value &lt; 0.05 -&gt; отклоняем нулевую гипотезу о “равенстве распределений”."
  },
  {
    "objectID": "lecture5.html#чек-лист",
    "href": "lecture5.html#чек-лист",
    "title": "R и статистика в селекции: лекция 5",
    "section": "Чек-лист",
    "text": "Чек-лист\n\nНормальное распределение и центральная предельная теорема\nt-распределение\nАлгоритм статистического вывода\nОграничения теста Стьюдента"
  },
  {
    "objectID": "lecture6.html#план-лекции",
    "href": "lecture6.html#план-лекции",
    "title": "R и статистика в селекции: лекция 6",
    "section": "План лекции",
    "text": "План лекции\n\nКовариация, коэффициент ковариации.\nКорреляция, тестирование значимости коэффициента корреляции, непараметрические аналоги.\nПростая линейная регрессия: формула, реализация в R, интерпретация.\nОграничения линейной регрессии (в т.ч. нормальность распределения остатков)."
  },
  {
    "objectID": "lecture6.html#данные-для-работы",
    "href": "lecture6.html#данные-для-работы",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Данные для работы",
    "text": "Данные для работы\nНесколько сортов шпината, их урожайность и количество дней до сбора урожая.\n\nlibrary(tidyverse)\ndf &lt;- read_csv2('data/Spin.data.csv')\nhead(df)\n\n# A tibble: 6 × 3\n  Variety           Days Yield\n  &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;\n1 Virtuosa             9    47\n2 Vroeg Reuzenblad     9    54\n3 Vital R             10    50\n4 Eskimo              11    53\n5 Hybride 320         12    65\n6 Hybride 22          13    77\n\nstr(df)\n\nspc_tbl_ [13 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Variety: chr [1:13] \"Virtuosa\" \"Vroeg Reuzenblad\" \"Vital R\" \"Eskimo\" ...\n $ Days   : num [1:13] 9 9 10 11 12 13 16 18 19 20 ...\n $ Yield  : num [1:13] 47 54 50 53 65 77 69 81 85 98 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Variety = col_character(),\n  ..   Days = col_double(),\n  ..   Yield = col_double()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt;"
  },
  {
    "objectID": "lecture6.html#посмотрим-на-данные",
    "href": "lecture6.html#посмотрим-на-данные",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Посмотрим на данные",
    "text": "Посмотрим на данные\nИспользуя базовую generic-функцию summary().\n\nsummary(df)\n\n   Variety               Days        Yield   \n Length:13          Min.   : 9   Min.   :47  \n Class :character   1st Qu.:11   1st Qu.:54  \n Mode  :character   Median :15   Median :71  \n                    Mean   :15   Mean   :71  \n                    3rd Qu.:19   3rd Qu.:81  \n                    Max.   :22   Max.   :98  \n\n\nПроверим, есть ли взаимосвязь между количеством дней до сбора урожая и урожайностью."
  },
  {
    "objectID": "lecture6.html#посмотрим-на-данные-1",
    "href": "lecture6.html#посмотрим-на-данные-1",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Посмотрим на данные",
    "text": "Посмотрим на данные\nС помощью функции skim() из пакета skimr.\n\nskim_res &lt;- skimr::skim(df)\nknitr::kable(skim_res)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_type\nskim_variable\nn_missing\ncomplete_rate\ncharacter.min\ncharacter.max\ncharacter.empty\ncharacter.n_unique\ncharacter.whitespace\nnumeric.mean\nnumeric.sd\nnumeric.p0\nnumeric.p25\nnumeric.p50\nnumeric.p75\nnumeric.p100\nnumeric.hist\n\n\n\n\ncharacter\nVariety\n0\n1\n4\n16\n0\n13\n0\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nnumeric\nDays\n0\n1\nNA\nNA\nNA\nNA\nNA\n15\n4.672615\n9\n11\n15\n19\n22\n▇▃▃▃▆\n\n\nnumeric\nYield\n0\n1\nNA\nNA\nNA\nNA\nNA\n71\n16.573071\n47\n54\n71\n81\n98\n▇▂▆▆▃\n\n\n\n\n\nЭто запись для презентации, обычно достаточно запустить:\n\n# install.packages('skimr')\nlibrary(skimr)\nskim(df)"
  },
  {
    "objectID": "lecture6.html#график-зависимости",
    "href": "lecture6.html#график-зависимости",
    "title": "R и статистика в селекции: лекция 6",
    "section": "График зависимости",
    "text": "График зависимости\n\nplot(df$Days, df$Yield)"
  },
  {
    "objectID": "lecture6.html#ковариация",
    "href": "lecture6.html#ковариация",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Ковариация",
    "text": "Ковариация\nСамая простая мера связи между двумя количественными переменными — это ковариация. Если ковариация положительная, то чем больше одна переменная, тем больше другая переменная. При отрицательной ковариации наоборот: чем больше одна переменная, тем меньше другая.\nФормула ковариации:\n\\[ \\sigma_{xy} = cov(x, y) = \\frac{\\sum_{i = 1}^n(x_i - \\overline{x})(y_i - \\overline{y})}{n} \\]\nОценка ковариации по выборке:\n\\[ \\hat{\\sigma}_{xy} = \\frac{\\sum_{i = 1}^n(x_i - \\overline{x})(y_i - \\overline{y})}{n-1} \\]\n\n\n\n\n\n\nЕсли оценить ковариацию переменной с самой собой, какая будет формула?"
  },
  {
    "objectID": "lecture6.html#ковариация-1",
    "href": "lecture6.html#ковариация-1",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Ковариация",
    "text": "Ковариация\nКовариация переменной с самой собой - это дисперсия.\nДавайте посчитаем ковариацию: функция cov().\n\ncov(df[,2:3])\n\n          Days    Yield\nDays  21.83333  70.2500\nYield 70.25000 274.6667\n\n\nПо главной диагонали ковариация переменной с самой собой - дисперсия.\nДля подсчета ковариации для двух величин:\n\ncov(df$Days, df$Yield)\n\n[1] 70.25\n\n\nМожем ли мы сделать вывод, это относительно большая ковариация между переменными или нет?"
  },
  {
    "objectID": "lecture6.html#коэффициент-корреляции",
    "href": "lecture6.html#коэффициент-корреляции",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Коэффициент корреляции",
    "text": "Коэффициент корреляции\nПроблема ковариации в том, что она привязана к исходной шкале и измеряется в пределах \\([-\\infty; \\infty]\\). Неплохо было бы иметь возможность нормировать. Для этого используется коэффициент корреляции.\nФормула коэффициента корреляции Пирсона:\n\\[ \\rho_{xy} = \\frac{\\sigma_{xy}}{\\sigma_x \\sigma_y} = \\frac{\\sum_{i = 1}^n(x_i - \\overline{x})(y_i - \\overline{y})}{\\sqrt{\\sum_{i = 1}^n(x_i - \\overline{x})^2}\\sqrt{\\sum_{i = 1}^n(y_i - \\overline{y})^2}} = \\frac{1}{n}\\sum_{i = 1}^n z_{x,i} z_{y, i} \\]\nОценка коэффициента корреляции Пирсона по выборке:\n\\[ r_{xy} = \\frac{\\hat{\\sigma}_{xy}}{\\hat{\\sigma}_x \\hat{\\sigma}_y} = \\frac{\\sum_{i = 1}^n(x_i - \\overline{x})(y_i - \\overline{y})}{\\sqrt{\\sum_{i = 1}^n(x_i - \\overline{x})^2}\\sqrt{\\sum_{i = 1}^n(y_i - \\overline{y})^2}} = \\frac{1}{n - 1}\\sum_{i = 1}^n z_{x,i} z_{y, i} \\]\nПо сути это ковариация, деленная на стандартное отклонение обеих переменных.\nКоэффициент корреляции измеряется в пределах \\([-1; 1]\\)."
  },
  {
    "objectID": "lecture6.html#вычисляем-корреляцию",
    "href": "lecture6.html#вычисляем-корреляцию",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Вычисляем корреляцию",
    "text": "Вычисляем корреляцию\nИспользуем функцию cor() базового R.\n\ncor(df$Days, df$Yield)\n\n[1] 0.9071588\n\n\nПосмотрим визуально на распределение данных.\n\nplot(df$Days, df$Yield)\n\n\nЗначим ли этот коэффициент корреляции?"
  },
  {
    "objectID": "lecture6.html#алгоритм-статистического-вывода",
    "href": "lecture6.html#алгоритм-статистического-вывода",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Алгоритм статистического вывода",
    "text": "Алгоритм статистического вывода\n\nФормулировка нулевой и альтернативной гипотезы.\nВычисление тестовых статистик.\nПодсчет p-value как площади под кривой выборочного распределения тестовых статистик.\nВывод: отклоняем или не отклоняем нулевую гипотезу."
  },
  {
    "objectID": "lecture6.html#тестируем-значимость-коэффициента-корреляции-r-теория",
    "href": "lecture6.html#тестируем-значимость-коэффициента-корреляции-r-теория",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Тестируем значимость коэффициента корреляции (r): теория",
    "text": "Тестируем значимость коэффициента корреляции (r): теория\n\\(H_0: r = 0\\)\n\\(H_1: r \\neq 0\\)\nНулевая гипотеза: коэффициент корреляции равен нулю.\nАльтернативная гипотеза: коэффициент корреляции не равен нулю.\nВ качестве тестовой статистики используется t-статистика.\nДля расчета p-value используется t-распределение с \\(n-2\\) степенями свободы, где n – размер выборки.\nМы это вручную считать не будем, воспользуемся встроенной функцией cor.test()."
  },
  {
    "objectID": "lecture6.html#расчет-с-помощью-функции-cor.test",
    "href": "lecture6.html#расчет-с-помощью-функции-cor.test",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Расчет с помощью функции cor.test()",
    "text": "Расчет с помощью функции cor.test()\n\ncor.test(df$Days, df$Yield)\n\n\n    Pearson's product-moment correlation\n\ndata:  df$Days and df$Yield\nt = 7.1502, df = 11, p-value = 1.868e-05\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.7121066 0.9722055\nsample estimates:\n      cor \n0.9071588 \n\n\nПо умолчанию рассчитывается коэффициент корреляции Пирсона: оценивает связь двух нормально распределенных величин. Выявляет только линейную составляющую взаимосвязи."
  },
  {
    "objectID": "lecture6.html#непараметрические-аналоги-коэффициента-корреляции-пирсона",
    "href": "lecture6.html#непараметрические-аналоги-коэффициента-корреляции-пирсона",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Непараметрические аналоги коэффициента корреляции Пирсона",
    "text": "Непараметрические аналоги коэффициента корреляции Пирсона\nЧасто используется коэффициент корреляции Спирмена (Spearman), если в данных есть выбросы. Математика метода точно такая же как у коэффициента Пирсона, только вместо оригинальных значений используются ранги.\nВ целом, непараметрические критерии не зависят от формы распределения и могут оценивать связь для любых монотонных зависимостей.\n\ncor.test(df$Days, df$Yield, method = 'spearman')\n\n\n    Spearman's rank correlation rho\n\ndata:  df$Days and df$Yield\nS = 38.553, p-value = 3.757e-05\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.8940861 \n\n\n\n\n\n\n\n\nНаличие значимого коэффициента корреляции ничего не говорит о причинно-следственной связи между переменными!"
  },
  {
    "objectID": "lecture6.html#непараметрические-аналоги-коэффициента-корреляции-пирсона-1",
    "href": "lecture6.html#непараметрические-аналоги-коэффициента-корреляции-пирсона-1",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Непараметрические аналоги коэффициента корреляции Пирсона",
    "text": "Непараметрические аналоги коэффициента корреляции Пирсона\nТакже есть коэффициент корреляции Кендалла.\n\ncor.test(df$Days, df$Yield, method = 'kendall')\n\n\n    Kendall's rank correlation tau\n\ndata:  df$Days and df$Yield\nz = 3.484, p-value = 0.000494\nalternative hypothesis: true tau is not equal to 0\nsample estimates:\n      tau \n0.7354992"
  },
  {
    "objectID": "lecture6.html#сравнение-различных-коэффициентов-корреляции",
    "href": "lecture6.html#сравнение-различных-коэффициентов-корреляции",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Сравнение различных коэффициентов корреляции",
    "text": "Сравнение различных коэффициентов корреляции\n\n\n\n\n\n\n\n\nПирсона\nСпирмена\nКендалла\n\n\n\n\nВыявляет линейную зависимость\nВыявляет любую монотонную зависимость\nВыявляет любую монотонную зависимость\n\n\nКоличественная или интервальная шкала\nшкала &gt;= ранговая (то есть ранговая, интервальная, количественная)\nшкала &gt;= ранговая\n\n\nНеустойчивость к выбросам\nУстойчивость к выбросам\nУстойчивость к выбросам"
  },
  {
    "objectID": "lecture6.html#данные-для-работы-1",
    "href": "lecture6.html#данные-для-работы-1",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Данные для работы",
    "text": "Данные для работы\n\nlibrary(readxl)\ndf_regr &lt;- read_xls('data/QM-mod7-ex2data.xls') %&gt;% \n  janitor::clean_names()\nhead(df_regr)\n\n# A tibble: 6 × 2\n  water_stress corn_yield\n         &lt;dbl&gt;      &lt;dbl&gt;\n1           74        0.2\n2           58        3.7\n3           53        4.1\n4           42        4.5\n5           39        4.8\n6           37        5.2\n\n\nДанные взяты отсюда"
  },
  {
    "objectID": "lecture6.html#какие-бывают-регрессионные-модели",
    "href": "lecture6.html#какие-бывают-регрессионные-модели",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Какие бывают регрессионные модели?",
    "text": "Какие бывают регрессионные модели?\n\n\nЛинейные и нелинейные\n\nЛинейные\n\\[ y = b_0 + b_1x \\] \\[ y = b_0 + b_1x_1 + b_2x_2 \\]\n\\[ y = b_0 + b_1x_1^2 + b_2x_2^3 \\]\nНелинейные\n\\[ y = b_0 + b_1^x \\] \\[ y = b_0^{b_1x_1+b_2x_2} \\]\n\nПростые и множественные"
  },
  {
    "objectID": "lecture6.html#линейная-регрессия-формула",
    "href": "lecture6.html#линейная-регрессия-формула",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Линейная регрессия: формула",
    "text": "Линейная регрессия: формула\nЛинейная регрессия позволяет предсказать значение одной переменной на основании значений другой. Обе переменные должны быть количественными.\nФормула для простой линейной регрессии - по сути это формула прямой из алгебры + остатки:\n\\[ Y = ax + b + \\epsilon \\]\n\\(Y\\) - зависимая переменная, что пытаемся предсказать, \\(\\epsilon\\) - это ошибки или остатки модели (residuals) - то есть то, что наша модель не смогла предсказать.\nДля более сложных моделей нотация немного меняется:\n\\[ Y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + ... + \\beta_nx_n + \\epsilon \\]"
  },
  {
    "objectID": "lecture6.html#линейная-регрессия-1",
    "href": "lecture6.html#линейная-регрессия-1",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Линейная регрессия",
    "text": "Линейная регрессия\nВ R функция для линейной регрессии - lm(). Давайте попробуем предсказать значение урожайности corn_yield на основании водного стресса (water_stress).\n\nmodel &lt;- lm(corn_yield ~ water_stress, data = df_regr)\nmodel\n\n\nCall:\nlm(formula = corn_yield ~ water_stress, data = df_regr)\n\nCoefficients:\n (Intercept)  water_stress  \n      9.7761       -0.1167  \n\n\nМы получили коэффициенты: Intercept, water_stress. Что это значит?\nКак эти коэффициенты подбираются?\n\n\nМетод наименьших квадратов (для простых моделей) -&gt; нарисовать\nМетод максимального правдоподобия (для более сложных)"
  },
  {
    "objectID": "lecture6.html#график-регрессионной-прямой-на-основании-полученных-коэффициентов",
    "href": "lecture6.html#график-регрессионной-прямой-на-основании-полученных-коэффициентов",
    "title": "R и статистика в селекции: лекция 6",
    "section": "График регрессионной прямой на основании полученных коэффициентов",
    "text": "График регрессионной прямой на основании полученных коэффициентов\ncorn_yield = Intercept + water_stress * Slope = 9.7761 + water_stress *(-0.1167) = 9.7761 - water_stress *0.1167\nПопробуем нарисовать регрессионную прямую на нашем графике.\n\n\nggplot(df_regr, aes(water_stress, corn_yield))+   \n  geom_point(alpha = 0.8)+  \n  geom_abline(slope = model$coefficients[2],\n              intercept = model$coefficients[1], \n              color = 'blue')+\n  theme_bw()"
  },
  {
    "objectID": "lecture6.html#предсказание-значений-на-основе-регрессионной-прямой",
    "href": "lecture6.html#предсказание-значений-на-основе-регрессионной-прямой",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Предсказание значений на основе регрессионной прямой",
    "text": "Предсказание значений на основе регрессионной прямой\nФункция predict() принимает на вход независимую переменную и предсказывает значение зависимой на основании нашей модели (подставляет в формулу).\nНапример, предскажем Yield для water_stress = 30. (Нужно подать именно датафрейм).\n\npredict(model, data.frame(water_stress = 30))\n\n       1 \n6.273693 \n\n\nФункция predict() ничего не знает о физическом смысле наших данных, поэтому мы можем предсказывать любые, даже неадекватные значения, например\n\npredict(model, data.frame(water_stress = -5))\n\n       1 \n10.35984 \n\n\n\n\n\n\n\n\nПредсказания регрессионной модели имеют смысл только “внутри” графика!\nЭто называется интерполяция, а экстраполяция почти всегда будет неверной."
  },
  {
    "objectID": "lecture6.html#экстраполяция-и-интерполяция",
    "href": "lecture6.html#экстраполяция-и-интерполяция",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Экстраполяция и интерполяция",
    "text": "Экстраполяция и интерполяция"
  },
  {
    "objectID": "lecture6.html#более-внимательно-посмотрим-на-вывод-регрессии",
    "href": "lecture6.html#более-внимательно-посмотрим-на-вывод-регрессии",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Более внимательно посмотрим на вывод регрессии",
    "text": "Более внимательно посмотрим на вывод регрессии\n\nsummary(model)\n\n\nCall:\nlm(formula = corn_yield ~ water_stress, data = df_regr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.1747 -0.5840 -0.1751  0.4677  2.1000 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   9.776106   0.218576   44.73  &lt; 2e-16 ***\nwater_stress -0.116747   0.008096  -14.42 9.25e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7953 on 29 degrees of freedom\nMultiple R-squared:  0.8776,    Adjusted R-squared:  0.8734 \nF-statistic: 207.9 on 1 and 29 DF,  p-value: 9.249e-15\n\n\nЧто все это значит?"
  },
  {
    "objectID": "lecture6.html#самое-важное-из-вывода-регрессии",
    "href": "lecture6.html#самое-важное-из-вывода-регрессии",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Самое важное из вывода регрессии",
    "text": "Самое важное из вывода регрессии\n\nsummary(model)$coefficients\n\n               Estimate  Std. Error   t value     Pr(&gt;|t|)\n(Intercept)   9.7761061 0.218575990  44.72635 2.616475e-28\nwater_stress -0.1167471 0.008096258 -14.41988 9.249406e-15\n\n\np-value есть для каждого коэффициента,\n\\(H_0: Intercept = 0, Slope = 0\\).\n\\(H_1: Intercept \\neq 0, Slope \\neq 0\\).\nКакое значение p-value для нас важнее?\n\nКоэффициент наклона.\n\nКак рассчитывается значимость коэффициента наклона?\n\nРассчитывается относительно “нулевой” модели - то есть модели, в которую входит только интерсепт."
  },
  {
    "objectID": "lecture6.html#коэффициент-детерминации---мера-качества-модели",
    "href": "lecture6.html#коэффициент-детерминации---мера-качества-модели",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Коэффициент детерминации - мера качества модели",
    "text": "Коэффициент детерминации - мера качества модели\n\\(R^2\\) - коэффициент детерминации. Описывает какую долю дисперсии зависимой переменной объясняет модель.\n\\[ R^2 = \\frac{\\color{blue}{SS_{r}}}{SS_{t}} \\]\n\nИзмеряется от \\([0, 1]\\).\n\\(R^2 = r^2\\) – для простой линейной регрессии коэффициент детерминации – квадрат коэффициента корреляции Пирсона."
  },
  {
    "objectID": "lecture6.html#допущения-линейной-регрессии",
    "href": "lecture6.html#допущения-линейной-регрессии",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Допущения линейной регрессии",
    "text": "Допущения линейной регрессии\n\nЛинейная связь\nНезависимость\nГомогенность дисперсий\nОтсутствие коллинеарности предикторов (для множественной регрессии)\nНормальное распределение ошибок -&gt; проиллюстрировать другие графики в R\n\nplot(model)"
  },
  {
    "objectID": "lecture6.html#линейность-связи",
    "href": "lecture6.html#линейность-связи",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Линейность связи",
    "text": "Линейность связи\nНелинейность связи видно на графиках остатков.\n\n\n\n\n\n\n\n\nПроверка на линейность связи:\n\nГрафик зависимости y от x (и от других переменных, не включенных в модель).\nГрафик остатков от предсказанных значений.\n\nЧто делать с нелинейностью данных?\n\nДобавить неучтенные переменные или взаимодействия\nПрименить линеаризующее преобразование (Осторожно!)\nПрименить обобщенную линейную модель с другой функцией связи (GLM)"
  },
  {
    "objectID": "lecture6.html#график-остатков-для-наших-данных",
    "href": "lecture6.html#график-остатков-для-наших-данных",
    "title": "R и статистика в селекции: лекция 6",
    "section": "График остатков для наших данных",
    "text": "График остатков для наших данных\n\nggplot(data.frame(fit = fitted(model), res = residuals(model)), aes(x = fit, y = res)) +\n  geom_point() +\n  geom_hline(yintercept = 0, linetype = 2) +\n  xlab(\"Fitted\") +\n  ylab(\"Residuals\")+   \n  theme_bw()"
  },
  {
    "objectID": "lecture6.html#график-остатков-для-наших-данных-output",
    "href": "lecture6.html#график-остатков-для-наших-данных-output",
    "title": "R и статистика в селекции: лекция 6",
    "section": "График остатков для наших данных",
    "text": "График остатков для наших данных"
  },
  {
    "objectID": "lecture6.html#независимость-данных",
    "href": "lecture6.html#независимость-данных",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Независимость данных",
    "text": "Независимость данных\nКаждое значение \\(y_i\\) должно быть независимо от любого другого \\(y_j\\).\nЭто возможно проконтролировать на этапе сбора данных\nНаиболее частые источники зависимостей:\n\nПсевдоповторности (когда измерили один и тот же объект несколько раз)\nВременные и пространственные автокорреляции\nНеучтенные переменные"
  },
  {
    "objectID": "lecture6.html#нормальное-распределение-ошибок",
    "href": "lecture6.html#нормальное-распределение-ошибок",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Нормальное распределение ошибок",
    "text": "Нормальное распределение ошибок\nМожно проверить с помощью qqPlot().\n\ncar::qqPlot(model$residuals)\n\n\n[1] 17 16"
  },
  {
    "objectID": "lecture6.html#проверка-на-гомогенность-дисперсий-гомоскедастичность",
    "href": "lecture6.html#проверка-на-гомогенность-дисперсий-гомоскедастичность",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Проверка на гомогенность дисперсий (гомоскедастичность)",
    "text": "Проверка на гомогенность дисперсий (гомоскедастичность)\nМногие тесты чувствительны к гетероскедастичности.\nЛучший способ проверки на гомогенность дисперсий — график остатков от предсказанных значений.\n\nggplot(data.frame(fit = fitted(model),                               res = residuals(model)), aes(x = fit, y = res)) +\n  geom_point() +\n  geom_hline(yintercept = 0, linetype = 2) +\n  xlab(\"Fitted\") +\n  ylab(\"Residuals\")+   \n  theme_bw()"
  },
  {
    "objectID": "lecture6.html#проверка-на-гомогенность-дисперсий-гомоскедастичность-output",
    "href": "lecture6.html#проверка-на-гомогенность-дисперсий-гомоскедастичность-output",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Проверка на гомогенность дисперсий (гомоскедастичность)",
    "text": "Проверка на гомогенность дисперсий (гомоскедастичность)"
  },
  {
    "objectID": "lecture6.html#проверка-на-гомогенность-дисперсий",
    "href": "lecture6.html#проверка-на-гомогенность-дисперсий",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Проверка на гомогенность дисперсий",
    "text": "Проверка на гомогенность дисперсий\n\nвзято из презентации Марины Варфоломеевой"
  },
  {
    "objectID": "lecture6.html#чек-лист",
    "href": "lecture6.html#чек-лист",
    "title": "R и статистика в селекции: лекция 6",
    "section": "Чек-лист",
    "text": "Чек-лист\n\nКовариация и корреляция\nЛинейная регрессия, интерпретация коэффициентов\nОграничения линейной регрессии"
  },
  {
    "objectID": "lecture7.html#план-лекции",
    "href": "lecture7.html#план-лекции",
    "title": "R и статистика в селекции: лекция 7",
    "section": "План лекции",
    "text": "План лекции\n\nМножественная линейная регрессия\nКоэффициент детерминации\nОднофакторный дисперсионный анализ"
  },
  {
    "objectID": "lecture7.html#формулировка-множественной-линейной-регрессии",
    "href": "lecture7.html#формулировка-множественной-линейной-регрессии",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Формулировка множественной линейной регрессии",
    "text": "Формулировка множественной линейной регрессии\n\\[ Y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + ... + \\beta_nx_n + \\epsilon \\]\nИнтерпретация коэффициентов:\nIntercept (интерсепт, перехват) – значение зависимой переменной, когда все независимые равны нулю.\nКоэффициент перед предиктором: показывает на сколько единиц изменится значение зависимой переменной в случае, если значение этого предиктора изменится на единицу, а все другие показатели не изменятся."
  },
  {
    "objectID": "lecture7.html#геометрический-смысл",
    "href": "lecture7.html#геометрический-смысл",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Геометрический смысл",
    "text": "Геометрический смысл\nДля двух коэффициентов теперь фитим (подгоняем) плоскость в трехмерном пространстве.\n\\(Y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + \\epsilon\\)\n\nДля большего количества предикторов нарисовать нет возможности, но смысл остается тот же самый."
  },
  {
    "objectID": "lecture7.html#нотация-формул-линейных-моделей-в-r",
    "href": "lecture7.html#нотация-формул-линейных-моделей-в-r",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Нотация формул линейных моделей в R",
    "text": "Нотация формул линейных моделей в R\n\n\n\n\n\n\n\nМодель\nФормула\n\n\n\n\nПростая линейная регрессия\nY ~ X\n\n\nПростая линейная регрессия, без интерсепта b0\nY ~ -1 + X\n\n\nУменьшенная простая линейная регрессия (только интерсепт)\nY ~ 1\nY ~ 1 - X\n\n\nМножественная линейная регрессия\nY ~ X1 + X2"
  },
  {
    "objectID": "lecture7.html#нотация-формул-линейных-моделей-в-r-1",
    "href": "lecture7.html#нотация-формул-линейных-моделей-в-r-1",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Нотация формул линейных моделей в R",
    "text": "Нотация формул линейных моделей в R\n\n\n\n\n\n\n\nЭлемент формулы\nЗначение\n\n\n\n\n:\nВзаимодействие предикторов\nY ~ X1 + X2 + X1:X2\n\n\n*\nВсе возможные взаимодействия\nY ~ X1*X2 тоже самое, что и\nY ~ X1+X2 + X1:X2\n\n\n.\nY ~ .\nВ правой части формулы записываются все переменные из датафрейма, кроме Y"
  },
  {
    "objectID": "lecture7.html#условия-применимости-множественной-линейной-регрессии",
    "href": "lecture7.html#условия-применимости-множественной-линейной-регрессии",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Условия применимости множественной линейной регрессии",
    "text": "Условия применимости множественной линейной регрессии\n\nЛинейная связь (=отсутствие паттерна на графике остатков).\nНезависимость наблюдений.\nГомогенность дисперсий.\nНормально распределение ошибок (остатков).\nОтсутствие влиятельных наблюдений.\nОтсутствие коллинеарности предикторов (для множественной регрессии)\n\nВсе условия совпадают с требованиями к простой линейной регрессии + проверка на коллинеарность.\nВообще перечисленные выше условия применимости совпадают и с многими другими статистическими тестами (и это не случайно!)"
  },
  {
    "objectID": "lecture7.html#данные-для-работы-с-регрессией",
    "href": "lecture7.html#данные-для-работы-с-регрессией",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Данные для работы с регрессией",
    "text": "Данные для работы с регрессией\n\nlibrary(tidyverse)\ndf_maize &lt;- read_csv('data/ex3.csv')\nhead(df_maize)\n\n# A tibble: 6 × 5\n  drought     N yield   rep  line\n    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1      -4   0   2992.     1     1\n2      -4  28.0 3534.     1     1\n3      -4  56.0 2901.     1     1\n4      -4  84.1 5759.     1     1\n5      -4 112.  7631.     1     1\n6      -4 140.  6723.     1     1\n\n\nЗависимая переменная – урожайность (yield), независимые переменные – степень засухи от -4 до 4 (drought), количество удобрения (N), реплика и линия."
  },
  {
    "objectID": "lecture7.html#посмотрим-на-данные",
    "href": "lecture7.html#посмотрим-на-данные",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Посмотрим на данные",
    "text": "Посмотрим на данные\n\n\nggplot(df_maize, aes(N, yield))+\n  geom_point()"
  },
  {
    "objectID": "lecture7.html#добавим-переменную-засухи-и-линию-регрессии",
    "href": "lecture7.html#добавим-переменную-засухи-и-линию-регрессии",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Добавим переменную засухи и линию регрессии",
    "text": "Добавим переменную засухи и линию регрессии\n\n\nggplot(df_maize, aes(N, yield))+\n  geom_point(aes(color = drought))+\n  geom_smooth()"
  },
  {
    "objectID": "lecture7.html#проверим-корреляцию-каждой-переменной-с-каждой",
    "href": "lecture7.html#проверим-корреляцию-каждой-переменной-с-каждой",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Проверим корреляцию каждой переменной с каждой",
    "text": "Проверим корреляцию каждой переменной с каждой\nС помощью функции cor(). Но мы не получаем p-value для тестов.\n\ncor(df_maize)\n\n          drought         N       yield         rep       line\ndrought 1.0000000 0.0000000  0.71394080  0.00000000 0.00000000\nN       0.0000000 1.0000000  0.20700055  0.00000000 0.00000000\nyield   0.7139408 0.2070006  1.00000000 -0.05199154 0.09821234\nrep     0.0000000 0.0000000 -0.05199154  1.00000000 0.00000000\nline    0.0000000 0.0000000  0.09821234  0.00000000 1.00000000\n\n\nФункция cor.test() дает p-value только для одной пары переменных."
  },
  {
    "objectID": "lecture7.html#проверим-корреляцию-каждой-переменной-с-каждой-1",
    "href": "lecture7.html#проверим-корреляцию-каждой-переменной-с-каждой-1",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Проверим корреляцию каждой переменной с каждой",
    "text": "Проверим корреляцию каждой переменной с каждой\n\nlibrary(psych)\npsych::corr.test(df_maize[,1:3])\n\nCall:psych::corr.test(x = df_maize[, 1:3])\nCorrelation matrix \n        drought    N yield\ndrought    1.00 0.00  0.71\nN          0.00 1.00  0.21\nyield      0.71 0.21  1.00\nSample Size \n[1] 324\nProbability values (Entries above the diagonal are adjusted for multiple tests.) \n        drought N yield\ndrought       0 1     0\nN             1 0     0\nyield         0 0     0\n\n To see confidence intervals of the correlations, print with the short=FALSE option\n\n\nПо умолчанию используется поправка Холма на множественные сравнения."
  },
  {
    "objectID": "lecture7.html#визуализация-корреляций",
    "href": "lecture7.html#визуализация-корреляций",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Визуализация корреляций",
    "text": "Визуализация корреляций\n\nlibrary(corrplot)\ncorrplot(cor(df_maize))"
  },
  {
    "objectID": "lecture7.html#коэффициент-детерминации-формула",
    "href": "lecture7.html#коэффициент-детерминации-формула",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Коэффициент детерминации: формула",
    "text": "Коэффициент детерминации: формула\nОбозначается как \\(R^2\\) – доля объясненной дисперсии.\n\\[ R^2 = \\frac{SSR}{SST} \\]\n\\(SSR = \\sum_i{(\\hat{y_i}-\\overline{y})^2}\\) - объясненная моделью дисперсия.\n\\(SSE = \\sum{(y_i - \\hat{y_i})^2}\\) - необъясненная дисперсия.\n\\(SST = SSR + SSE = \\sum_i{(y_i-\\overline{y})^2}\\) - общая дисперсия.\nОбъясненную моделью дисперсию можно вычислить как разницу между общей дисперсией и необъясненной дисперсией (\\(SSR = SST - SSE\\)).\nРазберем на рисунке:"
  },
  {
    "objectID": "lecture7.html#коэффициент-детерминации-график",
    "href": "lecture7.html#коэффициент-детерминации-график",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Коэффициент детерминации: график",
    "text": "Коэффициент детерминации: график"
  },
  {
    "objectID": "lecture7.html#коэффициент-детерминации-расчет",
    "href": "lecture7.html#коэффициент-детерминации-расчет",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Коэффициент детерминации: расчет",
    "text": "Коэффициент детерминации: расчет\n\ndf_test &lt;- data.frame(\n  x=c(0.9, 1.8, 2.4, 3.5, 3.9, 4.4, 5.1, 5.6, 6.3),\n  y=c(1.4, 2.6, 1.0, 3.7, 5.5, 3.2, 3.0, 4.9, 6.3))\nsst &lt;- sum((df_test$y - mean(df_test$y))^2) # общая сумма квадратов, SST\nssr &lt;- sst - sum((df_test$y - predict(model, data.frame(x = df_test$x)))^2)\nr2 &lt;- ssr / sst\nr2\n\n[1] 0.6132867\n\n\n\n\nsummary(lm(y ~ x, data = df_test)) # все сходится\n\n\n\nCall:\nlm(formula = y ~ x, data = df_test)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.5482 -0.8037  0.1186  0.6186  1.8852 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept)   0.5813     0.9647   0.603   0.5658  \nx             0.7778     0.2334   3.332   0.0126 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.19 on 7 degrees of freedom\nMultiple R-squared:  0.6133,    Adjusted R-squared:  0.558 \nF-statistic:  11.1 on 1 and 7 DF,  p-value: 0.01256"
  },
  {
    "objectID": "lecture7.html#коэффициент-детерминации",
    "href": "lecture7.html#коэффициент-детерминации",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Коэффициент детерминации",
    "text": "Коэффициент детерминации"
  },
  {
    "objectID": "lecture7.html#интерпретация-коэффициента-детерминации",
    "href": "lecture7.html#интерпретация-коэффициента-детерминации",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Интерпретация коэффициента детерминации",
    "text": "Интерпретация коэффициента детерминации"
  },
  {
    "objectID": "lecture7.html#множественная-линейная-регрессия",
    "href": "lecture7.html#множественная-линейная-регрессия",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Множественная линейная регрессия",
    "text": "Множественная линейная регрессия\nМожно использовать несколько предикторов для объяснения зависимой переменной.\nБольше предикторов - лучше модель?\n\nmodel_full &lt;- lm(yield ~ drought + N + line, df_maize)\nsummary(model_full)\n\n\nCall:\nlm(formula = yield ~ drought + N + line, data = df_maize)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -5263  -1276     11   1308   4790 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 8093.590    368.448  21.967  &lt; 2e-16 ***\ndrought      782.192     40.524  19.302  &lt; 2e-16 ***\nN              8.092      1.446   5.596 4.71e-08 ***\nline         555.650    209.264   2.655  0.00832 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1883 on 320 degrees of freedom\nMultiple R-squared:  0.5622,    Adjusted R-squared:  0.5581 \nF-statistic:   137 on 3 and 320 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "lecture7.html#проблема-мультиколлинеарности-во-множественной-линейной-регрессии",
    "href": "lecture7.html#проблема-мультиколлинеарности-во-множественной-линейной-регрессии",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Проблема мультиколлинеарности во множественной линейной регрессии",
    "text": "Проблема мультиколлинеарности во множественной линейной регрессии\nМультиколлинеарность — наличие линейной зависимости между независимыми переменными в регрессионной модели.\nПри наличии мультиколлинеарности оценки параметров неточны, увеличиваются стандартные ошибки, а значит сложно интерпретировать влияние предикторов на отклик.\nДля множественной линейной регрессии очень плохо, когда независимые переменные коррелируют друг с другом. Чтобы оценить, насколько у нас выражена автокорреляция, построим еще раз плот корреляций (пакет corrplot, функция corrplot()).\n\ncorrplot(cor(df_maize[,1:4]))\n\n\nАвтокорреляция выражена не очень сильно.\n\n\n\n\n\n\nСовет\n\n\nЕсли есть проблема с мультиколлинеарностью, можно посчитать VIF, подробнее спросить у лектора"
  },
  {
    "objectID": "lecture7.html#дисперсионный-анализ-anova",
    "href": "lecture7.html#дисперсионный-анализ-anova",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Дисперсионный анализ (ANOVA)",
    "text": "Дисперсионный анализ (ANOVA)\nДисперсионный анализ (analysis of variance, ANOVA) — метод для сравнения средних в трех и более группах.\nВиды дисперсионного анализа:\n\nОднофакторный (one-way)\nДвухфакторный (two-way)\nMANOVA (Multivariate analysis of variance)\nANCOVA\n\nМы будем подробно рассматривать первые два."
  },
  {
    "objectID": "lecture7.html#данные-для-работы",
    "href": "lecture7.html#данные-для-работы",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Данные для работы",
    "text": "Данные для работы\n\nlibrary(readxl)\ndf_aov &lt;- read_xlsx('data/CRD.1.data.xlsx')\ndf_aov\n\n# A tibble: 9 × 3\n    Pop   Rep Yield\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1   7.5     1  8.64\n2   7.5     2  7.84\n3   7.5     3  9.19\n4  10       1 10.5 \n5  10       2  9.29\n6  10       3  8.99\n7  12.5     1  6.64\n8  12.5     2  5.45\n9  12.5     3  4.73"
  },
  {
    "objectID": "lecture7.html#однофакторный-дисперсионный-анализ-формула",
    "href": "lecture7.html#однофакторный-дисперсионный-анализ-формула",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Однофакторный дисперсионный анализ: формула",
    "text": "Однофакторный дисперсионный анализ: формула\n\n\n\n\n\n\n\n\n\n\n\nСтепени свободы\nСуммы квадратов\nСредние квадраты\nF-статистика\n\n\n\n\nМежгрупповые\n\\(df_{b} = J - 1\\)\n\\(SS_{b}\\)\n\\(MS_{b} =\\frac{SS_{b}}{df_{b}}\\)\n\\(F=\\frac{MS_{b}}{MS_{w}}\\)\n\n\nВнутригрупповые\n\\(df_{w} = N - J\\)\n\\(SS_{w}\\)\n\\(MS_{w} =\\frac{SS_{w}}{df_{w}}\\)\n\n\n\nОбщие\n\\(df_{t} = N - 1\\)\n\\(SS_{t}= SS_{b} + SS_{w}\\)\n\n\n\n\n\n\\(J\\) означает количество групп, \\(N\\) - общее количество наблюдений во всех группах."
  },
  {
    "objectID": "lecture7.html#однофакторный-дисперсионный-анализ-формула-1",
    "href": "lecture7.html#однофакторный-дисперсионный-анализ-формула-1",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Однофакторный дисперсионный анализ: формула",
    "text": "Однофакторный дисперсионный анализ: формула\n\n\n\n\n\n\n\n\n\n\n\nСтепени свободы\nСуммы квадратов\nСредние квадраты\nF-статистика\n\n\n\n\nМежгрупповые\n\\(df_{b} = J - 1\\)\n\\(SS_{b}= \\sum\\limits_{j=1}^J \\sum\\limits_{i=1}^{n_j} (\\overline{x_j}-\\overline{x})^2\\)\n\\(MS_{b} =\\frac{SS_{b}}{df_{b}}\\)\n\\(F=\\frac{MS_{b}}{MS_{w}}\\)\n\n\nВнутригрупповые\n\\(df_{w} = N - J\\)\n\\(SS_{w}= \\sum\\limits_{j=1}^J \\sum\\limits_{i=1}^{n_j} (x_{ij}-\\overline{x_j})^2\\)\n\\(MS_{w} =\\frac{SS_{w}}{df_{w}}\\)\n\n\n\nОбщие\n\\(df_{t} = N - 1\\)\n\\(SS_{t}= \\sum\\limits_{j=1}^J \\sum\\limits_{i=1}^{n_j} (x_{ij}-\\overline{x})^2\\)\n\n\n\n\n\n\\(n_j\\) означает количество наблюдений в группе \\(j\\), а \\(x_{ij}\\) - наблюдение под номером \\(i\\) в группе \\(j\\)."
  },
  {
    "objectID": "lecture7.html#посчитаем-p-value",
    "href": "lecture7.html#посчитаем-p-value",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Посчитаем p-value",
    "text": "Посчитаем p-value\n\ndf_aov$Pop &lt;- as.factor(df_aov$Pop)\nfit1 &lt;- aov(Yield ~ Pop, df_aov)\nsummary(fit1)\n\n            Df Sum Sq Mean Sq F value  Pr(&gt;F)   \nPop          2 25.537  12.769    19.2 0.00247 **\nResiduals    6  3.989   0.665                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "lecture7.html#ограничения-anova",
    "href": "lecture7.html#ограничения-anova",
    "title": "R и статистика в селекции: лекция 7",
    "section": "Ограничения ANOVA",
    "text": "Ограничения ANOVA\n\nНезависимость наблюдений.\nНормальность распределения исходных данных - под вопросом (тоже самое, что и про t-test).\nРавенство дисперсий исходных данных - необязательно, если дизайн сбалансированный.\nНормальность распределения остатков - очень важно.\nРавенство дисперсии распределения остатков"
  },
  {
    "objectID": "lectures.html",
    "href": "lectures.html",
    "title": "Список лекций",
    "section": "",
    "text": "Здесь будет размещаться список презентаций и видеозаписей.\nЛекция 1. Введение в R.\n\nСлайды.\nЗапись.\n\nЛекция 2. Разбор селекционного примера с помощью линейной модели (lm) в R и сравнение выводов с Доспеховым.\n\nСлайды\nСкрипт (при переходе на страницу нажмите на “download raw file” в правом верхнем углу)\nДанные\nЗапись\n\nЛекция 3. Типы переменных и шкал, понятие генеральной совокупности и выборки, описательная статистика и статистика вывода - в чем разница.\n\nСлайды.\nЗапись.\nПро пределы погрешностей – статья.\nСкрипт и данные.\n\nЛекция 4. Визуализация данных с помощью ggplot2\n\nСлайды\nЗапись\nДанные\n\nЛекция 5. Что такое p-value, нормальное распределение, t-распределение, тест Стьюдента. Мощность тестов (?).\n\nСлайды\nЗапись\nЭффективная организация работы в R – статья про проект-ориентированный подход в работе\n\nЛекция 6. Корреляция и ковариация, простая линейная регрессия.\n\nСлайды\nЗапись\nПро корреляции (с википедии)\n\n\nЛекция 7. Множественная линейная регрессия. Однофакторный дисперсионный анализ (ANOVA).\n\nСлайды\nЗапись\n\nЛекция 8. Тест Стьюдента, ANOVA и линейная регрессия как частные случаи общей линейной модели. Введение в обобщенную линейную модель.\nЛекция 9. Применение статистических методов в селекции растений.\nЛекция 10-11 to be confirmed\nЛекция 12. Пакет metan для расчета индексов стабильности на основе AMMI и построения GGE биплота для графического отображения взаимодействия генотип-среда."
  }
]